# 数字电路（数电

12集开始

[TOC]





## 真值表（重点

定义：列出输入变量的各种取值组合及其对应输出逻辑值的表格

直观反映输出输入变量的逻辑关系，在分析和设计数字电路时都要进行列写

### 由逻辑表达式推出真值表

方法：按n为二进制数递增的方式列出输入变量的各种取值组合，然后求出对应的输出

例题：从后往前逐一改变![image-20240103130343479](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240103130343479.png)

### 由真值表得到逻辑表达式![image-20240103130802139](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240103130802139.png)

## 波形图

定义：输入变量和输出变量随时间变化的波形

横坐标时间轴，纵坐标是变量取值（只有0和1），输入和输出变量要对应画出

由波形图退出逻辑表达式，要先写出波形图对应的真值表，再由真值表写出逻辑式。

由逻辑表达式画出波形图，也是同理先得到真值表，然后再画出波形图。

## 逻辑函数化简

化简非常重要，对于电路图的简化无比重要，画电路图前一定要注意是否化简完毕——一般先将逻辑式化为最简与或式，然后变换得到需要的最简式

注意：无论是什么化简方法，逻辑式化简结果不唯一，不具有唯一性！！！![image-20240103132732781](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240103132732781.png)

### 公式化简法

1. 并项法：将两项合并从而消去一个变量

2. 吸收法：因为1+变量=1以及冗余项的原理，从而消除多余的与项

   冗余项：一个原变量，另一个与项有一个反变量，这两个项剩余的因子构成的第三项就是冗余项，可以直接消除忽视，如：A(非）B+AC+BC，这里的BC就是冗余项

3. 消去法![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240103135719852.png)

4. 配项法：在函数某一项乘以1（原变量加反变量等于1），将一项展开为两项，增加冗余项（与吸收法相反）

公式法缺点：不够直观，很难确定是否化为最简，因此需要以下的卡诺图法。

### 卡诺图（重难

#### 基础

排列顺序要按格雷码（循环码）来保证相邻性，按顺时针进行

二变量卡诺图![image-20240103144253824](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240103144253824.png)

三变量卡诺图，注意是按循环码排列的，不是按顺序排列

![image-20240103144822120](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240103144822120.png)

四变量卡诺图，同上同理，为4x4表格卡诺图，要注意排列顺序！！！注意这里第一列和第四列，第一行和第四行也相邻![image-20240103145639209](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240103145639209.png)

#### 卡诺图表示逻辑函数

基本步骤：

1.求逻辑函数的真值表，标准或一般与或式。

2.根据变量的个数画出变量卡诺图。

3.根据真值表，标准或一般式填写卡诺图

简单的例子：得到真值表了，然后找出真值表中输出值为1的最小项，在卡诺图对应的格中填1，其余格不填（因此记住卡诺图中每个格代表的最小项很重要）

非标准与或式————找交集，每一个或项隔开的与项找到卡诺图中的位置填1，然后找下一项直到结束，重复仍然填1

#### 卡诺图化简

优点：简单直观，以判断是否结果达到最简式。

缺点：适合变量较少的情况，一般用于变量个数在四个以下的式子化简

原理：利用卡诺图相邻性，对相邻最小项合并

方法：

1. 2个小方块相邻![image-20240103153124651](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240103153124651.png)

   消异存同是一个个变量地看，如上图填1的格子里，A都是0，相同取值为0所以保留为反变量，B同理，C一个为0另一个为1不同直接消去。因此化为最简就是A非B非

2. 4个小方块组成一个大方块，或组成同一行/列，或组成两行/列的两端，或出于四角，也可以合并，消除2个变量，同样也是消异存同

3. 8个小方块组成两行/列，或组成两边的两行/列，这样合并可以消掉3个变量

综上，化简步骤：

1.画出卡诺图，

2.填1

3.画出卡诺圈，把所有的1按2的n次圈起来

4.将所有的卡诺圈按消异存同得到最简形式。

画卡诺圈的技巧：先画含1多的小方块，即先找8个再找4个最后两个，如下：![image-20240103155614991](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240103155614991.png)

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240103155048572.png)

-特殊情况，当1个数过于多时，可以圈0，这样得到的是输出的反函数值。

### 有约束的逻辑函数化简

不可能存在的情况就是约束，这种条件就是约束条件，一般用“X”表示

m表示最小项，d表示约束项

约束条件的使用：视情况将“X”视为0或1，即可圈可不圈，对化简有利就圈反之不圈，如下例题![image-20240103161921497](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240103161921497.png)

也就是说，画圈要把所有1圈完，但是“X”不用圈完。

记住画圈规则：圈越大越好，越少越好！！

### 逆变器（与或门通过非门互相转换）

逆变器也可称为气泡( bubble)。这里的气泡其实就是非门（由于是圆圈长得像气泡），你可以想象，“推”一个气泡通过门使它从门的一边输入，在另一边输出,可以将与门替换成或门，反之亦然。例如,图2-19中的与非门是输出端包含气泡的与门。推一个气泡到左边会导致输入端带有气泡，并将与门变成或门。下面是推气泡的规则:
从输出端向后推气泡或者从输入端向前推气泡，将与门换成或门，反之亦然。
从输出端推气泡返回到输入端，把气泡放置在门的输入端。
向前推所有门输入端的气泡,把气泡放在门的输出端。

### 非法值X和Z

布尔代数限制为0和1。然而，真实电路中会出现非法值和浮空值，分别用X和Z来表示。

X表示电路结点有未知或非法值，比如之后的RS触发器，或者是一个结点同时被高电平和低电平驱动，**这种情况叫做竞争，**这种情况必须被避免，因为此时真实电压处于0-V~DD~之间，会导致高电平随意流动导致电路发热甚至被损坏

X也可以表示未被初始化的值，在真值表中也可以表示不用非常关心的值

Z表示结点既没有被高电平也没有被低电平驱动，**此时这个结点就是浮空状态**，浮空状态一些芯片允许，另一些不允许。而且浮空状态误差大非常容易受影响，一点微小静电可能对整个电路产生影响，因此一般不允许浮空

# 第二章门电路（牢记电子与电流方向相反）

 门电路可以按电路结构分为TTL集成门电路，CMOS集成门电路

TTL指Transistor-Transistor Logic输入端输出端都用三极管的逻辑门电路

CMOS是用互补对称MOS管构成的逻辑门电路

按功能特点（输出方式）分为普通门（推拉式输出），输出开路门，三态门，CMOS传输门

高电平和低电平是某规定范围的电位值，而不是固定值，比如：TTL电平输出高电平>2.4V，输出低电平<0.4V，室温下高电平3.5V...........

## 半导体器件开关特性

<u>**数电部分主要讲这些半导体器件的开关特性，不详细研究。其他特性和详细解释模电中会涉及**</u>

现代电子学，用的最多的半导体是硅和锗

本征半导体：完全纯净的，结构完整的半导体晶体，导电能力很弱。

导电机理：绝对零度（0K，-273摄氏度）和没有外界激发时，本征半导体中没有可以运动的带电粒子（载流子），导电能力为0相当于绝缘体。              但是常温下，**热激发（本征激发）**使一些价电子获得足够能量而脱离成为自由电子，留下的空位就是空穴。        因此，自由电子和空穴数量相等，而在其他力的作用下，空穴吸引附近的电子填补，相当于空穴的迁移，而这相当于电荷的移动，所以可以看作是电荷的移动

本征半导体电流由**自由电子和空穴移动产生**两部分电流组成

温度是半导体的一大特点——**温敏特性**

在本征半导体中参入微量杂质（某种元素）形成杂质半导体——**掺杂特性**，由于该特性掺杂四价以上的元素（比如P磷元素）后自由电子数目大量增加，这种就叫做电子半导体或**N型半导体**，这种半导体自由电子多，空穴少，掺杂四价以下（比如B硼元素）后空穴数量增加，自由电子少，就是**P型半导体**或**空穴半导体**。

无论N型P型半导体都是中性的，对外不显电性。

### 二极管

PN结，两种半导体在一起

![image-20240103173225110](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240103173225110.png)

PN结单向导电性 ，**P接正，N接负（正向偏置）**此时内电场被削弱，多子的扩散加强（外接电源提供更多电子）这会使得PN结变窄，电阻小，PN结导通。  **反向偏置**（P接负，N接正）内电场被加强，少子漂移效果加强，PN结变宽，电阻大，处于截止状态

而这样的PN结和套壳引线就组成了二极管，P半导体区是阳极，N半导体区是阴极

二极管的**静态开关特性**：死区电压是打通内电场需要的电压，击穿电压就是反向偏置彻底击坏PN结需要的电压![image-20240103175019366](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240103175019366.png)

输入为低电平，二极管反向截止，相当于开关断开

### 三极管

#### 结构

晶体管特指三极管，由NPN或PNP这样的半导体格式构成。![image-20240103181046968](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240103181046968.png)

#### 内部载流子的运动

**根据两个PN结施加的电压不同，四种不同的工作状态**![image-20240103194039247](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240103194039247.png)

1. **放大状态**：发射结正偏，集电结反偏（B电压大于E电压，C电压大于B电压）
2. **截止状态：**发射结反偏，集电结反偏
3. **饱和状态：**发射结正偏，集电结正偏
4. **倒置状态：**发射结反偏，集电结正偏

详细解释**放大状态**

如下：以NPN为例，基区薄而且杂质率低，减少电流Ibe

从基区扩散的电子到C为漂移，因为C集电极同为N半导体，电子更多，形成了电流Ice

电流Icbo是空穴漂移形成的电流，因此较少

![image-20240103190451240](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240103190451240.png)

因此有了**各电极电流之间的关系**，β一般大于1很多

 ![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E6%88%AA%E5%9B%BE20240103192558.png)

####  三极管静态开关特性

通过控制Ui，即电流iB的大小，使得U-I图上有多种曲线，iB越大，曲线越陡，根据这幅图，可以得到三极管的静态开关特性，放大截止饱和三个状态

**<u>但是注意这里数电重要的是开关特性也就是截止和饱和两个状态，其他的在模电中研究</u>**![image-20240103201958574](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240103201958574.png)

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E5%9B%BE%E7%89%8720240103203615.jpg)

判断三极管开关工作条件的方法：电流IBS为交流电UCC的电流，因此只需对比直流电iB与交流电IBS即可

![image-20240103204315916](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240103204315916.png)

### MOS管

场效应晶体管只有一种载流子参与导电，又被称为单极性三极管。是一种利用电压控制载流子运动的器件，目前应用最多的就是以二氧化硅作为绝缘介质的金属氧化物半导体绝缘栅型场效应管（MOS管），

分为N沟道和P沟道两类，每一类分为增强型和耗尽型UGS=0时增强型没有导电沟道，反之耗尽型漏源间仍存在导电沟道

#### MOS管结构图

半导体表面覆盖的绝缘层说明了MOS管抗干扰能力强

栅极横线靠近的一级是源极G‘<img src="https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104124007600.png" alt="image-20240104124007600" style="zoom:80%;" />

#### 工作原理

参考下面的图，这是正常未使用的情况，N型MOS管未导通原理如下。

正常使用时会在GS之间（即下图中实心黑点和空心圆点G之间）加一个电压，以形成导电沟道（在栅极）（源极一般接地）；原理：电压使得金属栅极G正电荷聚集，同电荷相斥，使得p中的多子空穴向下移动，留下带负电的离子形成**耗尽层**，随着GS间电压加大，耗尽层变宽

而GS增大到一定值时，衬底中的少子电子会被吸引到上方，在**耗尽层**和**绝缘层**之间形成N型薄层，这构成了漏源之间的导电沟道，此时GS的电压就是**开启电压T**，GS间电压再增大，导电沟道变宽，耗尽层宽度不变，从而实现用电压GS控制电流的放大。

而P型MOS管的电源应该在源极，源极电压够高才能达到开启电压



<img src="https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104130145694.png" alt="image-20240104130145694" style="zoom: 80%;" />

#### 符号

如图为耗尽型，绿框中的部分换为断开的三段短线，就是对应的未预埋导电沟道加强型

夹断电压同上的开启电压一个意义，达到电压会将沟道夹断。

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E6%88%AA%E5%9B%BE20240104131835.png)

#### 静态开关特性

当电压UG达到开启电压以后相当于开关闭合，DBS接通

反之未达到则是开关断开，DBS未接通

## 基本逻辑门电路（利用如上半导体实现）

### 分立门电路

#### 二极管与门

uA和uB为输入端，Y为输出端。

优先导通原理：电压高的通入，电压低的不通。这里的与门就是利用这一个原理，将二极管反接，实现01的情况不通

二极管与门相当于串联一个电阻，再串联一个并联了两个二极管的电路，通过输入端（A/B）是否输入电压抵消VCC，利用的是二极管的钳位功能（钳位：通过二极管后方电源（这里为A/B）电压控制二极管前方（这里为Y）的电压），得到输出端Y。

下图3V相当于高电平，0V相当于低电平，换成真值表就是如下，这样就实现了与门只有通入两个高电平才能输出一的特性。

| A           B  | Y    |
| -------------- | ---- |
| 0            0 | 0    |
| 0            1 | 0    |
| 1            0 | 0    |
| 1            1 | 1    |

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104140226430.png)

#### 二极管或门

与与门同理，利用优先导通原理，将二极管正接，实现01可以导通的效果，实现原理同与门近乎相同，只有VSS相反。

![image-20240104143318707](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104143318707.png)

#### 三极管非门

利用三极管的截止和饱和两个状态模仿开关，A处UI为输入端，Y为输出端，输入为低电平是截止状态，开关断开，Y直接连VCC，因此输出高电平。反之输入高电平，为饱和状态，开关闭合，由于前面涉及到的三极管特性，这里的UCE为0.3V属于低电平，即Y输出为低电平，这样就实现了非门

![image-20240104144936085](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104144936085.png)

### 异或门与同或门

可通过四个与非门搭建，也可以由真值表推出的卡诺图构建，奇数个高电平时输出高电平，因此可以用来判断奇偶电路。

取非就可以得到同或门

## TTL集成门电路（难点）

#### TTL与非门组成

![image-20240104154451095](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104154451095.png)

##### 输入级

T1多射极三极管相当于只有左边一端连接不同线路，其他端连接相同线路的两个三极管

钳位二极管D1D2为了防止负脉冲输入时，流向T1管发射极的电流过大，起到保护作用。因此不参与逻辑运算也可以省去。

##### 中间级

T2起倒相作用，集电极和发射极（箭头指向为发射极）同时输出相位相反的信号到达输出级的T3T4三极管

##### 输出级

T3，T4在输入信号经过多射极三极管，T2后的作用下，轮流导通，一个导通一个截止，这种称为推拉输出级

#### TTL与非门工作原理

输入端AB只要有一个为低电平0.3V，那么到达T2的电压（基极B由于VCC和R1（为1V）使T1深度饱和，CE间电压为0.1V到达集电极的就是0.4V），因此T2截止，进一步导致T4截止。而T3由于VCC和R2达到饱和，到达Y电压就是VCC-VR2（几乎为0）-VT3（0.7）-VD（0.7），输出高平电称为拉电流。

****

如果AB端都为高电平，那么同上相反，T2，T4导通，注意：这里由于T4的位置集电极向上对着输出端Y

通过计算可以得知（不深入讨论计算）T3截止。这里的T1利用了三极管的倒置状态（此时放大电流很小）

因此此时Y输出为低平电（通过计算可以得知这里的电流电压关系，由于过于麻烦按下不表，这里只讨论结论，想要深入讨论参考p27）

这时VCC不会经R4向T4灌入电流，T4集电极电流只能由外电路提供，这个电流叫做输出低电平电流IOL也叫灌电流。

#### TTL与非门电气特性

##### 输入端电源情况

![image-20240104164954792](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104164954792.png)

低电平为负，高电平三极管倒置状态，因此电流很小为漏电流。

##### 输入端负载情况

关门电压保证输出为高电平。

达到关门电平后R再增大会达到开门电阻，此时R再增大U也不会再升高，达到开门电阻此时对应的Uon就是开门电平，保证输出为低电平。

尽管输入端悬空，即R趋近于无穷大，T2T4饱和导通仍输出低电平，相当于在输入端接高电平

这里只有关门电阻和开门电阻的状态下有用，分别输出高电平和低电平。

![image-20240104165415371](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104165415371.png)

**<u>总括：终究是与非门，低电阻低电平输出高电平，高电阻高电平悬空输出低电平</u>**

##### 输出特性

注意：输出端不可以接地，否则短路电流过大达到-33ma，导致器件发热烧毁

![image-20240104170948719](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104170948719.png)

##### 输出端负载情况

![image-20240104172723455](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104172723455.png)

这里就是负载门有多个，每个连一个电阻和一个多射极三极管就是一个负载。因此最后流过所有负载门的电流就是IOL，流过其中一个负载门的电流就是IIL，相除就可以得到对应的负载门个数NOL（输出低电平扇出系数）

![image-20240104173237148](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104173237148.png)

与上面的灌电流负载电流流动方向和来源相反

##### 电压传输特性

转折处对应的输入电压就是阈值电压UTH，具体原理参考如上的工作原理。（实际结果就是与非门）

![image-20240104174200213](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104174200213.png)

##### 噪声容限

典型的输入输出高电平低电平及阈值，相减得到允许叠加的最大值UNH和UNL

![Collage_20240104_174646](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/Collage_20240104_174646.jpg)

### 其他两种较为特殊的TTL门电路

#### 集电极开路与非门（OC门）

##### 实现逻辑

与常见与非门缺少了T3和D，被替换为了一个电源和电阻，功能仍然一样。只有全部接高电平才会输出低电平，可以用优先导通的原则去理解（不确定）T2T3接通，低电平输出

<u>**注意这里的OC门并不包含电阻和电源部分，也就是说必须自己去外接一个电源和电阻**</u>

![image-20240104175442436](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104175442436.png)

##### 应用

一。普通OC门无法实现，因为普通OC门当Y1，Y2一个高电平一个低电平的情况下，T3来的高电平直接连到T4的低电平（伪接地）部分相当于直接短路。

而OC门不会，因为OC门这里缺少T3的特性，一路高电平，另一路会异于普通OC门而直接断开，故不会短路

![image-20240104180343467](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104180343467.png)

二。通过OC门外接的电源实现发光二极管的驱动，（有一个不是高电平时，断路无电流通过不发光）

注意普通与非门不可以，因为普通与非门输入都是高电平的情况下，输出端的低电平拉电流过于小，无法点亮![image-20240104183441545](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104183441545.png)

三。由于OC门外接电源的特殊性，实现电平转换，OC门后接其他门只需要改变外接的电源电压就可以实现对不同门的适配。![image-20240104191030660](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104191030660.png)

#### 三态门TSL门

##### 电路组成

普通的与非门多加红色框起来的部分电路形成三态门，使能端控制该与非门是否工作，有如下两种，会有第三种高阻态，这种状态当使能端有效时成立，此时T2，T4，T3，D都不通，输出端上下都断。

![image-20240104192428377](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104192428377.png)

##### 应用

一。EN非=1时，下图相反，A1禁止，A2使能，实现两种不同与非门切换

![image-20240104194331380](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104194331380.png)

二。A1，A2为信号两端，只要改变EN非，就可以实现信号不同方向的传输![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E6%88%AA%E5%9B%BE20240104194936.png)

三。灵活改变数据的传输，只需改变EN非![image-20240104195242812](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104195242812.png)

#### TTL集成门电路芯片

54系列和74系列，54用于军品要求更高，74用于民品

在不同子系列TTL中，器件型号后面几位数字相同时，通常逻辑功能，外形尺寸，外引线排列都相同。但是工作速度（延迟时间）和平均功耗不同，实际使用可以用高速门电路替换低速的，反之不行。

##### 芯片使用方面

普通TTL门输出端不允许直接并联使用，防止短路烧坏
三态输出门的输出端可并联使用,但同一时刻只能有一个门工作，其他门输出处于高阻状态。
集电极开路门输出端可并联使用，但公共输出端和电源Vcc之间应接上拉电阻Rc
输出端不允许直接接电源Vcc或直接接地。输出电流应小于产品手册上规定的最大值。

##### 芯片一个门电路闲置输入端的处理

与门和与非门多余输入端接逻辑1（接入VCC）或与有用输入端并接（不一定可以满足要求，可能电流分流使得门电路失效）、、、、**注意悬空的情况相当于加了VCC但是易受干扰，所以严格意义上要加VCC**、、、、或门和或非门多余输入端接逻辑0（接地）或与有用输入端并接（同样不是很靠谱）

##### 电源电压及干扰

对54系列电源电压应满足5V士10%，对74系列电源电压应满足5V土5%。

为防止动态尖峰电流或脉冲电流通过公共电源内阻耦合到逻辑电路造成干扰,需对电源进行滤波。

##### 焊接，接线问题

连线要尽量短，最好用绞合线;整体接地要好，地线要粗而短。

焊接用的电烙铁不大于25 W，焊接时间要短;焊接完毕后，只能用少许酒精清洗。

### CMOS集成门电路

CMOS逻辑电路偏向于使用与非门和或非门，而不是与门和或门

#### CMOS非门

原理：利用CMOS管的开关特性

输入为低电平时，N型MOS管未达到开启电压，Ugsn未导通截止；P型MOS管有外接的VDD达到开启电压导通，相当于开关闭合，输出高平电。如下为高电平，P型MOS管前后电压相抵，小于开启电压截止。下方N型导通，相当于输出端与地相连输出低电平

![image-20240104203156442](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104203156442.png)

优点：无论高平电低平电，上下MOS管总有一个截止，使静态漏极电流极小，所以功耗小。

#### 漏极开路的CMOS与非门（OD门）

与OC门相似，也要外接电阻和电源，效果相同，原理简单参考下图

![image-20240104204633619](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104204633619.png)

#### 传输门

记住C=0时不传输，C=1传输即可

![image-20240104205329598](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104205329598.png)

![image-20240104205428743](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104205428743.png)

#### 三态门（三态非门）

![image-20240104211024579](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104211024579.png)

上下VP2，VN2为三态门专属，中间的两个就是CMOS非门

### CMOS集成门电路使用事项

一、电源电压
1.注意不同系列CMOS电路允许的电源电压范围不同，一般多用+5V。电源电压越高,抗干扰能力也越强。

2.CMOS电路的电源电压极性不可接反,否则，可能会造成电路永久性失效.
3.在进行cmos电路实验，或对数字系统进行调试、测量时，应先接入直流电源，后接入信号源；使用结束时，应先关信号源，后关直流电源.

二、闲置输入端的处理

1.闲置输入端不允许悬空.
2.对于与门和与非门，闲置输入端应接正电源或高电平；对于或门和或非门的闲置输入端应接地或低电平.

3.闲置输入端不宜与使用输入端并联使用，因为这样会增大输入电容，从而使电路的工作速度下降.但在工作速度很低的情况下，允许输入端并联使用.

三、输出端的连接
1.输出端不允许直接与电源vop或地(VSS)相连.

2.为提高电路的驱动能力，可将同一集成芯片上相同门电路的输入端、输出端并联使用.
3.当cmos电路输出端接大容量的负载电容时，为保证流过管子的电流不超过允许值，需在输出端和电容之间串接一个限流电阻.

四、其他注意事项
1.焊接时，电烙铁必须接地良好，必要时，可将电烙铁的电源插头拔下，利用余热焊接.
2.集成电路在存放和运输时，应放在导电容器或金属容器内.
3.组装、调试时，应使所有的仪表、工作台面等有良好的接地.

### 电路延迟

组合逻辑电路的时序特征包括**传播延迟( propagation delaylay)和最小延迟**。**传播延迟t~pd~**是当输入改变直到一个或多个输出达到它们的最终值所经历的**最长**时间。**最小延迟t~ed~**是当一个输入发生变化直到任何一个输出开始改变的**最短**时间。

因此要计算延迟，要先找到输入到输出路上门个数最多的一条线路和门个数最少的一条线路，然后再分别计算出传播延迟和最小延迟

### 毛刺

一个输入信号的改变导致一个输出信号改变的情况。但是，一个输入信号的改变可能会导致多个输出信号的改变。由于延迟的原因，最终的输出有所波动，这称为毛刺(glitch)或者冒险( hazard ) 。

由于不同路到达最终输出经过的门电路数不同，延迟不同；因此本来不应该发生改变的最终结果发生改变，延迟结束后，最终结果又恢复回去。这里的波动就是毛刺。

因此真实的时序图上可能会有波动

毛刺产生和解决：

比如如下的卡诺图，电路图是根据2-77设计的，那么只要按画的两个圈改变变量值不会有毛刺，可是如图变量改变涵盖两个圈（这里B改变同时占两圆圈）就会产生毛刺，因此解决方法也很简单，只需要将这种可能涵盖两个圈的地方也圈起来（改变电路图，增加硬件个数）就可以避免毛刺

![image-20240207113215913](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240207113215913.png)

但是毛刺的存在影响不大，所以很多时候不用去消除所有毛刺，只要观察时序图时知道波动产生是由于毛刺影响即可

### 集成电路接口

驱动门输出提供给负载门的输入端

![image-20240104212529678](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104212529678.png)

TTL驱动CMOS无法驱动时的改装方法

![image-20240104212933999](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240104212933999.png)

CMOS驱动TTL

问题：CMOS 4000系列电路输出的高、低电平都满足要求，但由于TTL电路输入低电平电流较大，而CMOS 4000系列电路输出低电平电流却很小，灌电流负载能力很差，不能向TTL提供较大的低电平电流.应设法提高CMOS 4000系列电路输出低电平电流的能力.

方法：将同一个芯片上多个同作用门并联连接做驱动门，从而提高电压。或是加装一个CMOS驱动器，提高电流

特殊普适情况：高速CMOS电路驱动TTL电路
高速CMOS电路的电源电压VDP=VCC=5V时，CC74HC和CC74HCT系列电路的输出端和TTL电路的输入端可直接相连。所以一般不用之前普通CMOS电路驱动，过于麻烦。

# 第三章组合逻辑电路 

## 概论

### 分析

根据给定的电路图，先写出所有门电路的输出逻辑函数式，然后得到最终的输出逻辑函数式，然后进行化简，得到最简式之后按顺序列出真值表，最后根据真值表总结规律得到该电路的逻辑作用

遇到非常复杂的组合逻辑电路，可以分级写，将整体切割出多个部分，逐级写出各部分输出函数式，化简后结合到一起。

组合逻辑电路通过一些门电路的组合使用，真值表的筛查，可以得到更多使用的电路结构。

软件内仪器单里的逻辑变换器可以迅速实现电路图，逻辑表达式，真值表之间的转换。

### 设计

首先根据题干进行逻辑抽象，得到输入和输出的对应结果，然后列出真值表，得到真值表后画卡诺图进行化简，得到逻辑表达式，化完最简根据题干要求转换为对应格式（与非格式或与或等格式）

若遇到二进制码或其他码制转格雷码，可以列出真值表后结合空白卡诺图填真值表，再根据真值表画卡诺图得到各部分的逻辑函数表达式最简值。最后加在一起就是最终的逻辑表达式，据此设计电路即可

原理图（连线前电路图）规则：

- 输入在原理图的左边(或者顶部)。

- 输出在原理图的右边(或者底部)。

- 无论何时,门必须从左至右流。

- 最好使用直线而不使用有很多拐角的线(交错的线浪费精力考虑如何走线)。

- 线总是在T型接头连接。

- 在两条线交叉的地方有一个点,表示它们之间有连接。

- 在两条线交叉的地方没有点,表示它们没有连接。

## 常用中规模集成逻辑电路

### 复用器

复用器( multiplexer)是一种最常用的组合逻辑电路。根据选择( select)信号的值它从多个可能的输入中选择一个作为输出。复用器有时简称为mux。是译码器的基础

复用器有输入端和选择端和输出端，选择端数量是log~2~N，通过选择端选择哪一条输入端输出

结构较为简单，可以用与或门实现，也可以用三态缓冲器实现

精髓是可以用此优化电路，将原来的输入端变为选择端，可以使电路结构更加简单

### 加法器

#### 半加器

定义：两个1位二进制数相加，不考虑低位进法的加法，实现半加功能的电路。

规则：两个1位二进制数相加，结果有两个输出，半加和S（本位和），半加进位C(11进位)

缺点：只能计算两个1位二进制的情况，不能计算多位二进制数的相加

S=A异或B  C=AB（与项）

即转换为真值表就有下图：

| A    | B    | S    | C    |
| ---- | ---- | ---- | ---- |
| 0    | 0    | 0    | 0    |
| 0    | 1    | 1    | 0    |
| 1    | 0    | 1    | 0    |
| 1    | 1    | 0    | 1    |

#### 全加器

定义：将本位的2个二进制数和相邻低位来的进位数进行相加，全加指的是多个二进制数相加

全加真值表（Ai，Bi表示两个数中的第i位，Ci-1表示来自低位(第I-1位)的进位，Si表示全加和，Ci表示送给高位(第I+1位)的进位.

实际就是二进制数的简单相加，如下：

| Ai   | Bi   | Ci-1 | Si   | Ci   |
| ---- | ---- | ---- | ---- | ---- |
| 0    | 0    | 0    | 0    | 0    |
| 0    | 0    | 1    | 1    | 0    |
| 0    | 1    | 0    | 1    | 0    |
| 0    | 1    | 1    | 0    | 1    |
| 1    | 0    | 0    | 1    | 0    |
| 1    | 0    | 1    | 0    | 1    |
| 1    | 1    | 0    | 0    | 1    |
| 1    | 1    | 1    | 1    | 1    |

分析真值表后。得到关系式，推出逻辑表达式

Si = Ai 异或 Bi 异或 Ci-1
Ci = (Ai 异或 Bi) Ci-1+ AiBi

常用集成全加器：

双全加器：TTL：74LS183   CMOS：C661

全加器其中一个应用如下：

![image-20240106153130755](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240106153130755.png)

#### 串行进位加法器和超前进位加法器

实现多位二进制数加法运算的电路，进位方式有逐位进位(串行进位)和超前进位(并行进位)两种.

串行进位：低位进位输出端依次连至相邻高位的进位输入端，最低位进位输入端接地.因此，高位数的相加必须等到低位运算完成后才能进行，运算速度较慢.利用的是上面的全加器，依次相加![image-20240106155048085](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240106155048085.png)
超前进位：进位数直接由加数、被加数和最低位进位数形成.各位运算并行进行，运算速度快.复杂电路实现并行输出，同时得到多位结果，反应很快。

![image-20240106155154465](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240106155154465.png)

### 数值比较器

定义：对两个数字大小进行比较的逻辑电路

单位比较器：

包含三种结果（A>B,A<B,A=B)

逻辑表达式：

Y(A>B)=AB非

Y(A<B)=A非B

Y(A=B)=A非B非+AB=A异或B非

多位数值比较器：

从最高位开始逐位向低位进行比较，有一位不相等就直接输出结果，否则再往后比较，级联输入端用于更多位数值的比较，不需要使用时，”=“连1，其他两个连”0“。四位以上，八位比较就将两个下图比较器相连，低位的四位比较器输出端连到对应的级联输入端。![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240106161207541.png)

### 编码器

编码：用文字，符号或数字表示特定对象的过程，数电中用二进制编码，编码器就是实现编码功能的电路。

数电二进制编码：待编信号有n个，则所需二进制代码位数为N，有全编码和部分编码，全编码（8线-3线编码器）2的n次=N；部分编码（10线-4线编码器）2的n次>N（用不完全部的二进制编码可能）。  

#### 普通编码器

普通二进制编码器在某一时刻只能对一个输入信号进行编码即不允许有两个及两个以上同时有效的信号，有相互排除性。如下图为例全编码，I为输入信号，Y为二进制编码器的输出信号![image-20240106163709219](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240106163709219.png)

#### 优先编码器

定义：允许同时输入多个编码信号，并对优先级最高的信号进行编码输出，优先级高的排斥优先级低的单方面排斥特性

即从规定的优先级最高位开始向优先级降低的位数走，遇到输入信号（0）就直接输出，不管其他低优先级，反之遇到输入信号（遇到1），那么就往低优先级走

逻辑表达式：

Y2=I7+I6+I5+I4

Y1=I7+I6+I5非I4非I3+I5非I4非I2

Y0=I7+I6非I5+I6非I4非I3+I6非I4非I2非I1

![image-20240106165546752](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240106165546752.png)

功能表![image-20240106165915927](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240106165915927.png)

两片8线-3线组成16线-4线编码器，由于Y ES非有编码请求为低电平，没有编码请求为高电平（都为1不需要编码）所以可以将其连到Z3非，其他三位用与门，这样就可以实现四线的目标。![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E5%9B%BE%E7%89%8720240106171228.jpg)

当然也有10线-4线优先编码器如74LS147

### 译码器

由与门，开关，分线器集线器组成

将对应二进制码转换为特定信号输出

#### 二进制译码器与二-十进制译码器（注意下方的译码器都加了非号，所以0代表有效，1代表无效）

同普通编码器相反，道理相同

二进制常用3线-8线译码器74LS138![image-20240106174425212](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240106174425212.png)

译码过程就是编码过程的完全相反，但是要注意译码是高电平有效，而编码是低电平有效所以输出结果与编码的输入端相反

两个3线-8线译码器，译码器扩展为4线-16线译码器，如下A3的连接非常巧妙，E非控制是否工作，E非为0时正常工作。为1都不工作，其他输出同编码器完全相反![image-20240106175120842](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240106175120842.png)

二-十进制部分编码器（无使能端）4线-10线译码器，同对应的编码器相反

#### 显示译码器

将BCD码（十进制转二进制码）译成相应的输出信号驱动显示器显示相应数字

数码管（显示屏）

共阳极接法（简写AN）：a-g和DP（小数点位）低电平时对应发光二极管点亮（利用拉电流原理）电源连到二极管上，再连到显示译码器。

共阴极接法（简写CAT）：显示译码器连到二极管连到（近地）地上，利用灌电流原理，高电平时对应发光二极管亮。

集成译码器

LT非为了测试二极管发光正常，RBI非为了多个级联时使用

RBO非输出为0时RBI非和A1234都必须为0，否则RBO非只能输出1，当RBO非输入0时所有灯都灭，RBO非输出为零时，显示的0熄灭，叫做灭零（又叫消隐）

常规单独使用时三个功能端全部接到一个高电平里。

![image-20240107131917954](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240107131917954.png)

74LS48缺点：BCD码中的伪码出现时，灯的显示会出现乱码

多位数码管的动态灭零电路

利用的是整数位高位灭零，小数位低位灭零

![image-20240107134238225](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240107134238225.png)

CD4511三个功能端，LE（锁存功能为1时，会将上一步的数字保存下来，此时不管A传入什么都不会改变输出的数字。），BI非（只要为0，一定消隐，不管其他信号），LT非（只要为0灯全亮，是灯测试端），正常工作时T非和BI

非都要接1，LE接0

优点是BCD码中的伪码出现时，灯的显示不会出现乱码，而是消隐。

### 数据选择器

根据地址信号（相当于要传入信号的拨号开关），从多路传输数据中选择一路输出的电路，（又称多路选择器）

这里由于地址码输入和多路输入的关系，实际上是进制的转换，因此有2选1，4选1，8选1，16选1数据选择器（都是常见的2的n次方进制转换），这样地址码输入位数利用完全。 

构成：使能端ST非，A1A0地址码输入端，D0D1D2D3为多路输入端，Y为输出端![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240107143005657.png)

74LS153双4选1数据选择器，有两个完整的使能端多路输入段和输出端，但是地址码输入端只有一套，也就是说两套共用一个地址码输入端

8选1数据选择器74LS151，多了一个Y非，即输出端有两个，多输出一个反输出结果

数据选择器的扩展

双4选1扩展成8选1，如：74LS153将板分为两块（高位和低位），多一个地址输入端连到1ST上，，同时连一个非门到2ST上（保证高位和低位交替运行）两个输出端连到或门上最终输出

两片8选1连接成16选1，同上相同

### 数据分配器

根据地址信号，将一路输入数据分配到多路输出上，（与数据选择器恰好镜像）

可以利用译码器实现数据分配器，将输入端D连到不同的使能端取得不同的效果。

![image-20240107152606096](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240107152606096.png)

### 二进制译码器实现逻辑函数

由于n位二进制译码器可提供2“个最小项的输出，而任一个逻辑函数都可变换为最小项之和的标准与或式，因此利用译码器和门电路可实现单输出及多输出组合逻辑电路.
当译码器输出低电平有效时，选用与非门；译码器输出高电平有效时，选用或门.
基本步骤
(1)选择集成二进制译码器。
(2)写出待求函数的标准与非-与非式(两次取反)
(3)确定待求函数变量和译码器输入端的关系。
(4)选择合适的门电路，画连线图。

求标准与或式最好用卡诺图，这里用到的是原函数式转到卡诺图中，然后再根据卡诺图求出最小项与或与或式，然后两次取反得到与非与非式，然后就可以利用一个近似转化，逻辑函数中的ABC当作译码器的二进制码输入端，化简完后式子对应的最小项当作译码器对应的输出端，然后按照输出低电平还是高电平选择门电路即可。![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240107155012845.png)

![image-20240107155925914](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240107155925914.png)

逆向求解：给出电路图求逻辑表达式

直接画卡诺图，对应有输出连线到门电路卡诺图填1，对照卡诺图即可求出最简逻辑表达式。                                                   

### 数据选择器实现逻辑函数

步骤：
(1)根据n=k-1或n=k确定数据选择器的型号；
(n-选择器地址码，k-函数的变量个数)

(2)写出函数的标准与或式和选择器输出信号表达式；

(3)对照比较，确定选择器各个输入变量的表达式；

(4)根据采用的数据选择器和求出的表达式画出连线图。

#### n=k情况

##### 简单代数法

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E5%9B%BE%E7%89%8720240107165043.jpg)

##### 卡诺图法

先选择数据选择器，这里选用74LS151，然后分别画出函数表达式和数据选择器的卡诺图，最后比较两个卡诺图，得到对应关系![image-20240107165635805](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240107165635805.png)

#### n=k-1情况

##### 拼凑法

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E5%9B%BE%E7%89%8720240107171254.jpg)

##### 图形法（降维法）

适用于函数变量多的情况

先画出待求函数的降维卡诺图，再画出相应数据选择器输出信号的卡诺图，利用两者相等的关系，求出数据选择器输入变量的表达式.
一般将卡诺图的变量数称为该图的维数，如果**<u>把某些变量也作为卡诺图中小方格的值</u>**，则会减少卡诺图的维数，这种卡诺图称为“降维卡诺图”。

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E5%9B%BE%E7%89%8720240107171259.jpg)

<u>**注意**</u>:如果变量数较多，如4个，上述卡诺图降维的过程也比较复杂,也容易错，可采用“降维真值表”来进行快谏转换。

降维卡诺图->降维真值表

根据最简最小项与或式填写下表mi到abc的部分，如这里是A非BC+AB非C+ABC非+ABC，因此得下图

|  mi  |      A       |      B       | C（降维变量） | 方格 |
| :--: | :----------: | :----------: | :-----------: | :--: |
|  m3  |      0       |      1       |       1       |  C   |
|  m5  |      1       |      0       |       1       |  C   |
|  m6  | **<u>1</u>** | **<u>1</u>** |       0       |      |
|  m7  | **<u>1</u>** | **<u>1</u>** |       1       |      |

方格中填的数：降维变量对应为“1”，方格填原变量，对应为“0”填反变量，同时对应“0”和“1”，则填“1”，因此第一行和第二行方格都为C，而三四行AB相同且C相加为1，所以整体三四行两个方格为1

然后就可以据此画出降维卡诺图

# 第四章触发器（基础寄存器

## 概论

1、基本特点
(1)具有两个能自保持的稳定状态(稳态)。
通常用输出端Q的状态来表示触发器的状态.如Q=0、Q非=1时，表示0状态；Q=1，Q非=0时，表示1状态。
(2)在输入信号作用下，触发器的两个稳定状态可相互转换(状态的翻转)。
输入信号消失后，新状态可长期保持下来，具有记忆功能，可存储二进制信息.

2、触发器的作用
触发器和门电路是构成数字电路的基本单元.触发器有记忆功能，由它构成的电路在某时刻的输出不仅取决于该时刻的输入，还与电路原来状态有关(时序逻辑电路)。而门电路无记忆功能，由它构成的电路在某时刻的输出完全取决于该时刻的输入，与电路原来状态无关(组合逻辑电路)。

3.触发器的类型

按逻辑功能分：RS触发器，D触发器，JK触发器，T触发器，T `触发器
按触发方式分：电平触发器，边沿触发器，主从触发器
按电路基本结构分：RS触发器，同步触发器，主从触发器，边沿触发器

4，触发器逻辑功能的描述方法
主要有特性表、特性方程、激励表(驱动表)、状态转换图和波形图(时序图)等.

## 基本RS触发器

### 与非门构成的基本RS触发器

 注意SD和RD是否有非号，SD是置1端也称置位端，RD是置0端也称复位端当输入端都为0时此时里那个输出端都应该为1此时就发生了错误，实际输出01不定，因此这种情况禁用。

![image-20240128103622214](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240128103622214.png)

特性表：触发器次态Q“+1与输入信号和电路原有状态(现态q”)之间关系的真值表。
现态Q“：触发器接收输入信号之前的状态.
次态QN+1次：触发器接收输入信号之后的状态.
现态和次态是两个相邻时间里触发器输出端的状态.

特性表：

| RD非 | SD非 | Qn次 | Qn+1次 | 说明                   |
| :--: | :--: | :--: | ------ | ---------------------- |
|  0   |  0   |  0   | ×      | 触发器不允许           |
|  0   |  0   |  1   | ×      | 触发器不允许           |
|  0   |  1   |  0   | 0      | 触发器置0              |
|  0   |  1   |  1   | 0      | 触发器置0              |
|  1   |  0   |  0   | 1      | 触发器置1              |
|  1   |  0   |  1   | 1      | 触发器置1              |
|  1   |  1   |  0   | 0      | 触发器保持原有状态不变 |
|  1   |  1   |  1   | 1      | 触发器保持原有状态不变 |

![image-20240108142722138](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240108142722138.png)

RD非+SD非=1为约束条件（约束第一种情况的出现）

特性方程：Qn+1=SD+RD（或）非Qn

****

状态转换图

根据特性表得到

表示触发器从一种状态转换到另一种状态（或保持状态不变时），对输入信号的要求。

![image-20240108145342385](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240108145342385.png)

左右两个为稳定状态，输入端改变时经过上或下一个过程到达另一边的输出结果。

****

驱动表

根据触发器现态和次态（Qn，Qn+1）确定输入信号取值的关系表，又称激励表（输出推出输入）

信号波形图信号传输分时同时撤销情况，注意特殊情况（00）注意特殊情况后第一段的情况

![image-20240108151444269](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240108151444269.png)

### 或非门组成的RS触发器

注意这里的RD与SD未取反，而与非门都取反了，所以或非门的全部RD，SD取反后与与非门无异（与与非门组成的相反），其他表格数值相反

![image-20240108152324122](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240108152324122.png)

****

二者比较

或非与与非输入端取反，连到输出端的位置也反了（与非S连到Q，或非R连到Q）

![image-20240108152734398](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240108152734398.png)

### 基本RS触发器优缺点

优点：电路简单，具有置0，置1和保持功能，是构成各种触发器的基础，可用作数据寄存、消抖开关、脉冲变换.
缺点：1、输入电平直接控制输出状态，使用不便，抗干扰能力差。2、输入有约束条件。

### 基本RS触发器集成及使用

CMOS集成基本触发器CC4044，（与非门）但是注意没有Q非端

![image-20240108153144231](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240108153144231.png)

TTL：74LS279，与上者的最大不同是：TTL的有两个三输入端与非门，两个二输入端与非门。而上者为四个两输入端与非门。而且TTL的没有使能端

学过的门电路简单设计

原理：优先编码器和译码器联合使用使得十进制的抢答选手转为二进制存储，再由显示译码器解析在数码管显示对应的抢答选手，橙线控制优先编码器第一次抢答使能端为0，可以顺利传递信息。黑线控制第一次抢答信息传到两个锁存器中，然后会传高平电给优先编码器使能端，使之后的抢答信息无法通过优先编码器传递，确保只抢答一次就只有一个结果

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E6%88%AA%E5%9B%BE20240108155417.png)

### 基本RS触发器应用：消抖开关

**基础按键一般是机械弹性开关，当机械触点断开、闭合时，由于触点的弹性作用，按键在闭合时不会马上稳定地按通，在断开时也不会一下断开.按键按下时会有抖动，也就是说按了一次键，但实际产生的“按下”却是有多次的.这个抖动过程会对电路造成影响

按键的抖动时间由其机械特性决定，一般为5ms-20 ms。在做按键检测时都要加一个消抖的处理.
消抖可分为:硬件消抖和软件消抖.

硬件消抖在按键较少可用硬件方法消除键抖动.
软件消抖检测出键闭合后执行一个5-20 ms的延时，让前沿抖动消失后再一次检测键的状态，如果仍保持闭合状态电平，则确认为真正有键按下；按键释放也要做同样的延时处理.

因此有了消抖开关（硬件消抖）

上图为原电源与开关，下图为改进后的电源与开关

原理是利用触发器锁存，这样的设计使得开关打开关闭的抖动只会碰到上或下一端，而触发器除非输入端两个都改变，否则输出值不变，所以消除了抖动的影响。抖动过程不会出现上图不规则的电源输出。

![image-20240108161807765](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240108161807765.png)

## 同步触发器

### 同步RS触发器

特征方程：Qn+1=S+R非Qn

在数字系统中，为了协调各部分有节拍地工作，通常要求一些触发器在同一时刻动作。为此，必须采用同步脉冲，使这些触发器在同步脉冲作用下根据输入信号同时改变状态，而在没有同步脉冲输入时，触发器保持原状态不变，这个同步脉冲称为时钟脉冲CP(时钟脉冲)

具有时钟脉冲控制的触发器称为时钟触发器，又称钟控触发器。如下是在RS与非门触发器上加一个时钟门CP（利用两个与非门和CP控制端实现与其他门电路的配合，并<u>**实现SR向非的转换**</u>）因此如果CP=1列出SR的特性表则与或非门RS触发器相同

注意这里CP控制门为0，触发器输出不变，特殊情况：如果在RS都是1的不允许情况下突然CP置0，那么之后为不定状态。



![image-20240108163457580](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240108163457580.png)

增加异步输入端![image-20240110093101735](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240110093101735.png)

(1)RS称同步输入端，因为加在RS端的输入信号能否进入触发器而被接收，是受时钟脉冲CP同步控制的.
(2)SD非RD非称异步输入端，也称直接置位和复位端，当SD非=0时，触发器被置位到1状态，RD非=0时触发器被复位到0状态，其作用与CP无关.

异步输入端是用来预置触发器的初始状态，或在工作过程中强行置位和复位触发器，平时不工作时，SD=RD=1。

![image-20240108164448271](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240108164448271.png)

优点：时钟电平控制:在CP=1期间触发器接收输入信号，CP=0时保持状态不变，多个触发器可以在同一时钟脉冲控制下同步工作，给用户的使用带来了方便，其抗干扰能力也比基本RS触发器强得多。
缺点：1、存在不定状态，R、S之间仍有约束.2、存在空翻现象:在CP=1期间，输入信号的多次变化，使触发器的状态也随之多次变化，只能用于数据锁存，而不能用于计数器、寄存器和存储器中。

### 同步D触发器

特征方程：Qn+1=D

普通RS触发器和时钟门，但是一个输入端，一路直接连到**<u>S端</u>**，分一路出来经过**<u>非门</u>**到<u>**R端**</u>。此时RS不可能同时取1或0，因此没有了约束条件

当CP=0时即可保持原状态

特点：

1、时钟电平控制，输入无约束问题，优于同步RS触发器.
2、CP=1时改变，CP=0时才锁存。
3、仍然存在空翻现象，限制了同步触发器的应用。

集成同步D触发器：74LS375（但是用的是或非门，因此RS对应关系改变对调）

### 边沿D触发器

**<u>只在时钟脉冲CP的上升沿或下降沿接收输入信号</u>**，**而在CP=1及CP=0期间以及CP非约定边沿，触发器不接收数据，保持原态不变。**
作用：相对于同步(电平)触发器在CP-1期间接收输入信号，边沿触发器提高了工作的可靠性和抗干扰能力，且没有空翻现象.

如下为一种电路结构，**<u>对应简化图会在同步D触发器CP上方加一个表示方向的小三角形，因此边沿触发器最鲜明的特点就是三角形</u>**如下为下降电流改变型，沿下降沿改变则添加圆圈。

因此也有上升电流改变型，对应为正三角，没有小圆

![image-20240108175448311](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240108175448311.png)

工作原理：上分为从触发器受到CP非控制，下方为主触发器受CP控制

形象描述：D    ->  |主    Qm    |从     Q       主从为两个可开关的屏障

主触发器受CP控制，从触发器受cp‘=CP控制.
(1)CP=0时，G7、G8被封锁，G3，G4打开，从触发器的状态取决于主触发器，Q=QM，Q非=QM非，输入信号D不起作用。
(2)CP=1时，G7、G8打开，G3，G4被封锁，从触发器状态不变，主触发器的状态跟随输入信号D的变化而变化，即QM=D。

(3)CP下降沿到来时，封锁G7、G8，打开G3、G4，主触发器锁存CP下降沿时刻的值，即QM=D，随后将该值送入从触发器，使Q=D，Q非=D非。

(4)CP下降沿过后，主触发器锁存CP下降沿时D的值，而从触发器的状态也将保持不变。

因此下降沿改变，上升沿不变

简单来说CP下降沿到来D输入为什么就输出什么，其他CP取值的情况D都不变保持原值锁存。

****

集成边沿D触发器：74LS74，，是双D触发器，有两套上述边沿D触发器，并且两套都含有两个异步输入端RD非，SD非。

原理**<u>：异步置0端RD非和异步置1端SD非的置0、置1信号对触发器的控制作用优先于CP和D的信号</u>**.因此该种集成触发器要正常工作时RD非和SD非都要同时取1，**注意不可以同时取0**

优缺点：

1、CP的上升沿(正边沿)或下降沿(负边沿)触发。

2、抗干扰能力极强，解决了同步触发器的“空翻”现象。
3、功能太少，只有置1、置0功能。

### 边沿JK触发器

其中一种下降沿型电路图如下：

![image-20240108182827299](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240108182827299.png)

原理：根据电路图推算，特征方程Qn+1（现态）=JQn非+K非Qn（次态）

特性表

| J（主导地位 |  K   |  Qn  |   CP   | Qn+1 | 说明 |
| :---------: | :--: | :--: | :----: | :--: | :--: |
|      0      |  0   |  0   | 下降沿 |  0   | 保持 |
|      0      |  0   |  1   | 下降沿 |  1   | 保持 |
|      0      |  1   |  0   | 下降沿 |  0   | 置0  |
|      0      |  1   |  1   | 下降沿 |  0   | 置0  |
|      1      |  0   |  0   | 下降沿 |  1   | 置1  |
|      1      |  0   |  1   | 下降沿 |  1   | 置1  |
|      1      |  1   |  0   | 下降沿 |  1   | 翻转 |
|      1      |  1   |  1   | 下降沿 |  0   | 翻转 |

功能表（简化特性表）<u>**11翻转，00不变，否则以j为主，j为什么输出什么**</u>

| J    | K    | Qn+1 |
| ---- | ---- | ---- |
| 0    | 0    | Qn   |
| 0    | 1    | 0    |
| 1    | 0    | 1    |
| 1    | 1    | Qn非 |

集成边沿JK触发器：74LS112，两个JK触发器，下降沿触发，同时含有两个异步输入端RD非SD非。同样异步输入端优先级最高，正常工作时RD非和SD非都要同时取1，**注意不可以同时取0**

### T触发器和T`触发器

特征方程：Qn+1=T与Qn（次态）异或

由JK触发器或D触发器构成，主要是用来简化集成计数器的逻辑电路.
T触发器是根据T端输入信号的不同，在时钟脉冲CP作用下具有翻转和保持功能的电路。

下降沿有效的情况下：T=0则输出保持不变，T=1则翻转。

下降沿到来时，读取的是此时刻稍微向前提取一点的T取值

****

T‘触发器是指每输入一个时钟脉冲CP时，状态变化一次的电路.它实际上是T触发器的翻转功能，即始终令T=1。

特征方程：Qn+1=Qn非

即只要有脉冲（上升沿**<u>或者</u>**下降沿）就进行翻转

T‘触发器实际上是一个“二分频器”，Q的周期是CP的2倍，频率则是CP的1/2。

### 触发器之间的转换

#### JK触发器----》D触发器

JK触发器特征方程：Qn+1=JQn非+K非Qn    D触发器特征方程：Qn+1=D

第一种方法：变换D触发器特征方程使之与JK触发器保持一致：

Qn+1=D（Qn非+Qn）=DQn非+DQn     所以  J=D，K=D非

第二种方法：使用驱动表（由特性表得到）

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E5%9B%BE%E7%89%8720240108192411.jpg)

#### JK触发器----》T触发器

JK触发器特征方程：Qn+1=JQn非+K非Qn    T触发器特征方程：Qn+1=TQn非+T非Qn ，因此J=T，K=T，只需输入端都连一根线到JK两输入端即可。

#### JK触发器----》T`触发器

JK触发器特征方程：Qn+1=JQn非+K非Qn    T`触发器特征方程：Qn+1=Qn非

因此J=1，K=1即K非=0，因此只需高电平连到JK两输入端即可

#### D触发器----》JK触发器，T触发器，T`触发器

直接使D=对应的特征方程，如到jk触发器，那么D=JQn非+K非Qn ，然后按照逻辑式连电路即可。到T触发器，D=T异或Qn。到T`触发器，D=Qn非=Qn+1

# 第五章时序逻辑电路（重——集成

定义：任何时刻电路的输出，跟该时刻电路的信号和原来电路的信号都有关、

特点：由存储电路和组合逻辑电路组成，与时间因素（CP）有关

分类

1. 按逻辑功能分： 计数器，寄存器，移位寄存器，读写存储器，顺序脉冲发生器

2. 按电路结构分：同步时序逻辑电路，异步时序逻辑电路

   同步时序逻辑电路：所有触发器的时钟端连在一起，所有触发器在同一个时钟脉冲CP控制下同步工作.

   异步时序逻辑电路：时钟脉冲CP只触发部分触发器，其余触发器由电路内部信号触发.因此，触发器不在同一时钟作用下同步工作.

3. 按信号输出特性：

Mealy型有限状态机：输出不仅与现态有关，而且还取决于电路的输入，输出方程为：Y=F（X，Q），Q，X都为某一瞬间状态取值，X为输入，Q为存储电路的输入

Moore型有限状态机：输出仅取决于当前输入状态

问题

异步电路中经常会出现竞争条件（不同状态叠加）而难以掌握。之所以出现竞争条件，是因为其电路的行为取决于两条通过逻辑门的路径中哪条最快。（考虑通过逻辑门的延迟）这样的电路可以工作，但是**<u>对于从表面上看似相同的电路，如果用几个延迟有些不同的门替换，可能就无法正常工作</u>**。或者，**<u>这样的电路只能在一定的温度和电压下正常工作</u>**，只有在这个特定的条件下其逻辑门的延迟才刚好正确。这种错误是极其难查出来的

**<u>由于组合逻辑没有环路和竞争。</u>**因此如果将输入应用到组合逻辑中，输出总是在传播延迟内稳定为一个正确的值。但是，包含环路的时序电路存在不良的竞争或不稳定的行为。分析这样的电路问题十分耗时。

为了避免时序电路这些问题，设计师在路径中插入寄存器来断开环路。**<u>这将电路转变成组合逻辑电路和寄存器的集合</u>**。寄存器包含系统的状态，这些状态仅仅在时钟沿到达时发生改变，所以我们说状态同步于时钟信号。如果时钟足够慢，使得在下一个时钟沿到达之前输入到寄存器的信号都可以稳定下来，那么**<u>所有的竞争都将被消除</u>**。根据反馈环路上总是使用寄存器的原则，可以得到同步时序电路的一个形式化定义。

综上，同步时序电路含有一个时钟输入，用**<u>当前状态</u>**和**<u>下一个状态</u>**区分目前系统的状态和下一个时钟沿系统将进入的状态。功能规范 详细说明了对于当前状态和输入值的各种组合，每个输出的下一个和值。时序规范 包括上界时间t~pcq~和下界时间t~ccq~，它是从时钟的上升沿直到输出改变的时间以及建立时间t~setup~。和保持时间t~hold~.它表示当输入必须相对于时钟的上升沿稳定。

同步时序电路，如果它由相互连接的电路元件构成,且有以下关系:

- 每一个电路元件或者是寄存器或者是组合电路。
- 至少有一个电路元件是寄存器。
- 所有寄存器都接收同一个时钟信号。

- 每个环路至少包含一个寄存器。
- 非同步的时序电路（多个时钟脉冲）就是异步电路

状态编码

状态编码中的一个重要决策是选择**<u>二进制编码还是选择独热编码</u>**。二进制编码(binary encoding)中一个二进制数代表—种状态。因为 log~2~K位可以表示K个不同的二进制数，所以有K个状态的系统只需要 log~2~K位状态。
在独热编码(one-hot encoding)中，状态的每一位表示一种状态。因为在任何时候只有一位是“热的”或TRUE。例如，一个有3个状态的有限状态机的独执编码为001、010和 100。状态的每一位存储在一个触发器中，所以独热编码比二进制编码需要更多的触发器。然而，使用独热编码，下一个状态和输出逻辑通常更简单，需要的门电路也更少。最佳编码方式取决于具体的有限状态机。



## 分析

注意这里是时序逻辑电路，所以CP一定要接交流电，否则不能满足最基本的时序要求。

1. 写方程式：时钟方程：各个触发器时钟信号的逻辑表达式，同步时序电路可省去不写.
   输出方程：时序电路的输出逻辑表达式，通常为现态和输入变量的函数.
   驱动方程：各触发器输入端的逻辑表达式.

2. 求状态方程：将驱动方程代入相应触发器的特性方程所得到的方程.

3. 计算，列状态表：

   状态表：将电路输入和现态的各种取值组合，代入状态方程和输出方程进行计算，求出相应的次态和输出.

   如现态的起始值已给定，则从给定值开始计算。如没有给定，则可设定一个现态起始值依次进行计算。

4. 画状态转换图，时序图

   状态转换图：指电路由现态转换到次态的示意图。
   时序图：在时钟脉冲CP作用下，各触发器状态变化的波形图。

5. 检查电路能否”自启动“

   能自启动：存在无效状态，但没有形成循环。
   不能自启动：存在无效状态,且形成了循环。

6. 电路功能说明：

   逻辑功能：根据状态表或状态转换图说明电路逻辑功能

例题分析：

### 同步时序电路

如下图电路，这是时钟CP下降沿触发的同步时序电路，分析时不必考虑时钟信号.没有外部输入，只有输出，且输出仅与现态有关，属Moore型时序电路.

第一步：驱动方程，有几个触发器就要写几个对应方程，如下第一步写出每个触发器的输入端方程，然后得到对应每个触发器输出端方程（状态方程）

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E5%9B%BE%E7%89%8720240110103233.jpg)

第二步：根据得到的状态方程写出状态表，如上图简单代入算得结果填写对应表格，然后就可以得到有效状态有效循环（有效状态构成的循环）（橙色框部分）以及无效状态无效循环（无效状态<u>**若**</u>构成循环）（绿框部分，这里未构成循环即无无效循环）正常工作时只会在有效循环内不断循环，无效状态是用来判断能否自启动的，不会循环时出现。

第三，四步：如下根据状态表得到状态转换图，可根据具体情况决定是否画时序图，一般情况下状态转换图就够用，随后根据状态转换图，得出5和6的具体情况

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E5%9B%BE%E7%89%8720240110105335.jpg)



5、检查电路能否“自启动”：
根据上图状态转换图，电路虽然存在无效状态，但没有形成循环，所以电路能自启动.即使电路由于某种原因进入无效状态，只要给足够的脉冲，就能返回到有效循环.

6、电路功能说明：
根据状态转换图，Q012的输出关系，该电路能对CP脉冲进行六进制计数,并在端输出一个下降沿作为进位输出信号（Y输出1），因此为“同步六进制计数器”

这样例题分析就结束了。

p68，69习题及分析，忘了或模糊可以去做！

### 异步时序电路

在异步时序电路中,只有部分触发器由时钟脉冲CP触发,其它触发器由电路内部信号触发。分析异步时序电路时需写出时钟方程,并特别注意各触发器的时钟条件在何时满足，其状态方程才能使用。

同上面同步时序电路的分析相同，只不过由于异步，所以CP端要提出来分析，如下图列状态表时，有关的CP条件（后两个JK触发器 CP与Q0有关）要写出上升沿还是下降沿（所以要在Q0处分析出上升沿下降沿，CP符合才能进行相应的改变）

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E5%9B%BE%E7%89%8720240110125440.jpg)

## 设计

### 同步时序电路

一。基本步骤：设计要求——》原始状态转换图——》最简状态转换图——》状态分布——》选触发器，求时钟，输出和状态方程——》求驱动方程——》画电路图——》检查电路能否自启动

**<u>一定要注意这里所有的卡诺图变量顺序都是由大到小，由Q2-》Q1-》Q0</u>**

<img src="https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E5%9B%BE%E7%89%8720240110133129.jpg" style="zoom:25%;" />

如上图，由状态转换图求出输出Y的逻辑表达式，然后画出**<u>次态卡诺图</u>**，由次态卡诺图拆开就可以得到各个触发器的卡诺图，由各自的卡诺图可以推出各自的逻辑表达式（驱动方程），**<u>再将驱动方程转换为对应的触发器格式（如JK触发器就转换为JQn+KQn的形式</u>**），注意：这里可以添加约束项去化简，如果结果复杂，可以将约束项加进来尝试进一步化简（**<u>这里的化简很重要，涉及到后面对于自启动的检查</u>**）|||||||然后就可以得出输入端（j和k）的取值，由此便可以得到电路。

注意如果不能自启动，要及时切换思维，改变状态转换图使之可以达到自启动的目标。

以下是复杂的状态转换图思考改变过程

如题目，输入三个或三个以上输入为1，否则为0。因此想到四个状态（原始状态，1个1，2个1，3个及以上1）根据条件画出最原始的状态转换图，然后进行化简（输入输出状态相同”等价状态“则合并），化为最简后要得到二进制形式，这里用了00（原始），01（1个1），11（两个1）表示，然后就可以正常按照流程选择触发器，求方程了。

<img src="https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E5%9B%BE%E7%89%8720240110135223.jpg" style="zoom: 25%;" />

### 异步时序电路

采用异步方案，为了直观清楚，需根据状态转换图画出对应的时序图，然后从翻转要求出发，为每个触发器选择合适的时钟信号.

选择时钟脉冲的基本原则:凡是要翻转的触发器都能够获得相应的时钟触发沿，且触发沿越少越好.
(1)选触发器
选用3个CP上升沿触的D触发器，分别用FF0、FF1、FF2表示.

（2）输出方程（这一步同上同步时序电路相同即画输出Y的卡诺图）

#### 重点：时钟方程

根据状态图先画出时序图，再根据翻转条件选脉冲，如下得到FF1，FF2的翻转条件选择相同脉冲Q0非

然后正常画卡诺图求出各个触发器的卡诺图，**<u>然后到达最不一样的地方，翻转不是CP的Q1和Q2卡诺图要把没有时钟信号的次态作为约束项处理（打❌）</u>**，然后正常求出驱动方程，转换格式，得到对应每一个的J，K。最后得到电路图。

最后不要忘记检查电路能否自启动！！！

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E5%9B%BE%E7%89%8720240110152737.jpg)

## 计数器

一、计数器(计数器)的作用
用于累计输入时钟脉冲(CP)的个数，还常用于分频、定时、产生脉冲序列和进行数字运算，是一种Moore型时序电路

.二、计数器的分类

按数的进制分：二进制计数器，十进制计数器，N进制计数器

按计数方式分：加法计数器，减法计数器，可逆计数器

按时钟控制分：同步计数器，异步计数器

三，计数器的计数规律

比如两位二进制加法计数器（每有一次脉冲加1）会有：00-》01-》10-》11-》00两位二进制减法计数器则将过程相反。还有三位，四位等等进制计数器

8421码也一样到达1001后再有一次脉冲就会变成0000，持续循环。

四。一些概念

 计数的最大数目称为计数器的“模”，用M表示.模也称为“计数长度”或“计数容量”。
五进制计数器也称模5计数器；十进制计数器则为模10计数器，3位二进制计数器为模8计数器.

n个触发器有2的n次种输出，也就可以作为模2的n次计数器

### 二进制同步计数器

#### 二进制加法同步计数器

设计方法二，通过观察Q2n，Q1n，Q0n之间的规律得到如下二进制同步加法计数器的原理及规律

![image-20240110160401362](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240110160401362.png)

全按T触发器，不同的连线方式串行并行如下：

![image-20240110160730014](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240110160730014.png)

按照T`触发器改装脉冲，则有下方电路图

![image-20240110161837286](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240110161837286.png)

#### 二进制减法同步计数器

二进制加法同步计数器规律和各处方程的变量全部取非就可以得到二进制减法同步计数器，其他地方全部相同。

#### 二进制可逆同步计数器

在加减控制信号管理下，将二进制同步加法计数器和二进制同步减法计数器组合起来，就是二进制可逆计数器

单时钟输入二进制同步可逆计数器

通过加/减控制端，取0则是加法，取1则是减法

![image-20240110163729083](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240110163729083.png)

双时钟输入二进制同步可逆计数器

![image-20240110164124759](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240110164124759.png)

CPu为0为减计数，为1加计数

#### 集成（重，**<u>记！</u>**

集成4位同步二进制加法计数器  74LS161和74LS163，161与163几乎完全一样，唯一不一样的地方就是清零端低电平有效时，161为异步置0，而163为同步置0（必须有一个CP上升沿才能置0||而161不需要这一个CP上升沿，只要给CR端低电平立刻置0）

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E5%9B%BE%E7%89%8720240110165828.png)

集成4位同步二进制可逆计数器

单时钟    74LS191

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E5%9B%BE%E7%89%8720240110171540.jpg)

双时钟     74LS193

注意这里是异步置数，而上面的单时钟芯片则是同步置数

补充：

CR：异步清零端，高电平有效

CPu：加法计数脉冲输入端

CPd：减法计数脉冲输入端

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E5%9B%BE%E7%89%8720240110172417.jpg)

注意最后一点功能，正确级联可以得到更多位制的计数器

### 二进制异步计数器

#### 设计

根据之前的设计路线，可以得到Q1，Q2时钟沿为Q0

然后设计路线相同，拆分得到各自的卡诺图，按异步时序电路的设计，将没有时钟信号的次态作为约束项处；画完卡诺图后得到驱动方程化为对应格式即可。![image-20240123200435225](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240123200435225.png)

将触发器接成T'触发器,然后级联，将计数脉冲CP从最低位时钟端输入，其它各位时钟端接法如下表:
                                                       															T"触发器的触发沿

| 计数规律 | 上升沿      | 下降沿      |
| -------- | ----------- | ----------- |
| 加法计数 | CPi= Qi-1非 | CPi= Qi-1   |
| 减法计数 | CPi= Qi-1   | CPi= Qi-1非 |

#### 集成二进制异步计数器

![Collage_20240123_202723](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/Collage_20240123_202723.jpg)

只要将二进制端的输出端连到八进制的输入端即可实现十六进制计数器

### 十进制同步计数器

设计路线同之前一样，这里就可以联想到8421BCD码进行加法计数

由于设计路线相同，这里不做解释

十进制同步可逆计数器
(1)先画出按照8421BCD码进行十进制可逆计数的状态图,添加加/减控制信号U/D，为0时作加法计数，为1时做减法计数。再选择触发器，求输出、状态、驱动方程，即可画出逻辑电路图。
(2)将前面介绍的十进制加法计数器和减法计数用与或门组成起来，并用U/D作为控制信号。
(3)在4位二进制(十六进制)同步可逆计数器的基础上，通过修改驱动逻辑和输出逻辑,可以获得单时钟或双时钟2种类型的可逆计数器。

****

**集成十进制计数器：74LS160，74LS162**

这两个与二进制集成计数器极其相似。端口功能相同（置0，计数，置数，保持）

同样的是这两个芯片唯一不同之处也是：160异步置0，162同步置0

**可逆计数器74LS190**（单时钟）（与191集成二进制计数器极其相似）

有U非/D加减控制端

**可逆计数器74LS192**（双时钟）（与193集成二进制计数器极其相似）

因为以上四个芯片在端口名字**功能上与二进制对应的芯片几乎相同**，因此具体端口功能参考**<u>二进制集成部分对应的芯片</u>**

****

### 十进制异步计数器

同上，过程相同，先画时序图求出脉冲，然后画出整体的的卡诺图，再拆分求出各自的卡诺图，将没有脉冲的时候换为约束项，然后根据各自的卡诺图，分别求出各自的驱动方程，转换为对应的形式，即可求出对应的电路图形式。

集成

二—五—十进制异步计数器74LS290，18个管脚，实际的接口端为14个，同二进制集成部分的197芯片极其相似，都是涵盖了二进制和五进制的两块加法计数器芯片，同上相同两块芯片连用实现十进制（根据五进制芯片脉冲不同的连法，会产生不同码制，如8421BCD码，5421BCD码）

功能：

()异步清0功能:当S~9~,=S~9A~·S~9B~=0时，若R=R~0A~·R~0B~=1，计数器异步清0。
(2)异步置9功能:当S~9~=S~9A~·S~9B~=1时，计数器异步置9。

(3)计数功能:当S~9A~·S~9B~=0且R~0A~·R~0B~=0时，在下降沿作用下进行加法计数。

### 小容量N进制计数器

方法：1.用触发器和门电路设计，2.用集成计数器构成(M =2或M =10)。
利用计数器的==“清零端”或“置数端”==可获得N进制计数器，且有异步和同步两种。

**以下芯片的管脚，功能，用法都要熟练掌握！！！！！！**

**同步清零74LS162 74LS163**
**异步清零74LS160 74LS161 74LS192 74LS193 74LS197 74LS290**
**同步置数74LS160 74LS161 74LS162 74LS163**
**异步置数74LS190 74LS191 74LS192 74LS193 74LS197 74LS290(置9)**

（详见集成部分）

#### 利用同步端设计

思路：当M进制计数到S~N-1~后使计数回到S0状态。

步骤：(1)写出状态S~N-1~的二进制代码;(2)求反馈归零逻辑表达式;(3)画连线图。

例题：

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E5%9B%BE%E7%89%8720240125075328.jpg)

这里例题使用的是清0端，如果使用的是置数端（LD非），那么D~0123~要接地

同时置零端不可能产生进位，置数端可以产生进位。如下：

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E5%9B%BE%E7%89%8720240125080230.png)

**将进制整体向下移动，同时利用置数端，在进位的同时进行置数，置为初始数，从而实现进位的N计数器。——==反馈置数法==（重）**，想要的n进制，n-芯片本身的进制数，比如制作六进制计数器，十进制芯片，那么10-6=4，该芯片输入端为4的数（就是Q~2~）设置为1，进位端C通过非门连到置1端。

#### 利用异步端设计

思路：当M进制计数到S~N~时,立即产生清零或置数信号，使计数回到S0状态。(瞬间即逝)

步骤：(1)写出状态S的二进制代码;
(2)求反馈归零逻辑表达式;3)画连线图。

原因：异步清零/置数方式,到了状态S~N~,借助S~N~的译码进行归零或置数,S~N~持续时间极短暂,约几十纳秒。同步脉冲为CP因此不需要脉冲，到N-1即可归零，而异步需要CP的脉冲，到N-1少一个脉冲，因此要到N的短暂脉冲实现归零。

#### 指出几进制计数器

先观察给出的芯片本身，知道该芯片的功能，观察芯片的端口连接，知道芯片这样连接的结果，然后观察置零端置数端，若接置数端且有初始状态就先从初始状态计0开始，向后一直到进位经过N，再观察同步还是异步，同步就是N+1进制，不然就是N进制。

实在看不出来就结合芯片功能图（输入输出功能）和脉冲图结合来看

窍门是熟练掌握各种芯片以及各种芯片各种状态下的状态表

反馈法构成N进制计数器小结:

- 利用集成计数器的清零或置数功能通过反馈控制可构成N进制计数器。
- 反馈归零法和反馈置数法的不同点:反馈归零法将反馈控制信号加至清零端CR 上;而反馈置数法则将反馈控制信号加至置数端LD上，且必须给置数输入端D3~D0加上计数起始状态值。
- 设计时，应弄清清零或置数功能是同步还是异步的，同步则反馈控制信号取自S~N-1~;异步则反馈控制信号取自S~N~。
- 若给定电路连接确定计数器的进制数,同步则将反馈信号对应二进制代码+1;异步则为对应的二进制代码。

### 大容量N进制计数器

1.取巧（级联刚好达到要求的N进制计数器，比如：10×10=100，2^4^×2^4^=256一类的级联计数器）

采用两片芯片同步级联时,外加时钟信号同时接到各片计数器的时钟输入端，可以用==前级计数器的进位输出CO==来控制后级计数器的计数控制端==CT~T~、CT~p~==，实现对后级计数器工作状态的控制。

当片(1)计到1111时,进位输出CO=1，片(2)CT,- CTP=1，使片(2)处于计数状态;当下一个CP到来时,片(2)加1,而片(1)归零(0000)，同时CO=0，使片(2)处于非计数状态。即通过第一个芯片的==进位端==实现对第二个芯片的控制。

精髓：要注意观察，用第一个芯片和第二个芯片的哪些输出端连到使能端CP~1~和CP~0~上，可以刚好实现进制的加法到大容量的跳跃。

比如：两个十进制芯片的级联去实现一个100进制异步计数器，利用十进制的特性，将两个芯片分为个位片和十位片，连接方法是Q~3~连到十位芯片的五进制脉冲端CP~0~——个位片进1到十位片，可以将Q~7~当作百进制进位信号。

2.无法取巧，只能先级联获得大进制计数器，再获得指定的N进制计数器
（1）**<u>集成计数器级联起来扩大容量后，再用反馈清零法或反馈置数法获得大容量的N进制计数器。</u>**

这里两片芯片同步级联，扩容后再减小到指定的小容量计数器，和之前小容量N进制计数器的部分连接方法一样。

（2）**<u>直接用级联法，将N进制计数器和N,计数器串联,获得N=N×N进制计数器。</u>**

比如60进制，可以将十进制芯片当作个位片，六进制芯片当作十位片，然后进行串联（利用置零端或置数端，处理方法同小容量部分相同）

这里级联的方法很多，有很多种级联的方法，合理考虑置数端，置零端，进位端，彼此配合，很多种连线方式实现N进制计数器，如下为置数端N×N的简单例子：

选一个个位片和十位片，分别构成对应的小容量N进制计数器，保证两n相乘为大N即可。

![image-20240125200740300](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240125200740300.png)

****

但是要注意使用的芯片是什么进制，什么代码

比如74LS160十进制8421代码，全程都要注意这是8421BCD码，不是平常的二进制代码，写状态对应代码，要转化为8421代码。这里利用反馈清零法或反馈置数法解决，比如以下例题：

![image-20240125204420013](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240125204420013.png)

## 寄存器

寄存器主要用以存放数码。移位寄存器不但可存放数码,还能对数码进行移位操作。移位寄存器有单向和双向移位寄存器。集成移位寄存器使用方便、功能全、输入和输出方式灵活。移位寄存器常用于实现数据的串/并行转换，构成环形计数器、扭环计数器和顺序脉冲发生器等。

寄存器分类：

1.按功能分：基本寄存器    并入并出

移位寄存器    并入并出、并入串出、串入并出、串入串出

2.按开关元件分：TTL寄存器    CMOS寄存器

### 基本寄存器

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E6%88%AA%E5%9B%BE20240125205344.png)

特点：并入并出，结构简单，抗干扰能力强

### 移位寄存器

寄存器中的数码在移位脉冲作用下左移或右移，又分为单向移位寄存器（左移右移）和双向移位寄存器

D ~i~为输入端，进入的是多位二进制信息，每提供一次CP上升沿，信息向右移一位，将最右边Q~3~的信息挤出去，这样实现信息的右移，左移就是右边D触发器的输出端连到左边一个D触发器的D输入端。

![20240125205915](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/20240125205915.png)

单向移位寄存器主要特点:
1.输入数码在CP控制下，依次右移或左移。
2.寄存n位二进制数码。n个CP完成串行输入,并可从Q~0~-Q~3~端获得并行输出,再经n个CP又获得串行输出。

3.若串行数据输入端为0，则n个CP后寄存器被清零。

集成：

74LS164——8位右移寄存器

![Collage_20240125_211604](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/Collage_20240125_211604.jpg)

双向移位寄存器74LS194

![Collage_20240125_211649](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/Collage_20240125_211649.jpg)

### 移位寄存器型计数器

若把移位寄存器的**输出**以一定方式反馈到**串行输入端**，则可以得到一些电路连接简单、编码别具特色的移位寄存器型计数器。

特点：电路结构简单，计数顺序一般为非自然态序。

环形计数器

![Collage_20240125_212830](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/Collage_20240125_212830.jpg)

这里无效循环的消除部分需要多次尝试，重新设计反馈电路

![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/v2-3adc89999d9921afdd78baeaa4bbe50f_720w.png)

主要特点:
1正常工作时所有触发器中只有一个是1(或0)，利用各触发器的Q端作为电路的状态输出,不需要附加译码器。																						 2当连续输入CP时,各触发器的Q端将轮流出现矩形脉冲这种电路称为环形脉冲分配器。
3利用率低,记N个数需要N个触发器。

****

扭环计数器

前面与环形计数器相同，但是**<u>最后一个D触发器输出端的非端</u>**连到第一个D'触发器输入端，而不是输出端

结果是形成一个有效循环和无效循环

可进行改进，消除无效循环

集成：5位扭环计数器CC4017

![Collage_20240125_220735](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/Collage_20240125_220735.jpg)

### 顺序脉冲发生器

在数字电路中,能按一定时间、一定顺序轮流输出脉冲波形的电路称为顺序脉冲发生器。
顺序脉冲发生器也称为脉冲分配器和节拍脉冲发生器,一般由计数器和译码器组成。
3顺序脉冲发生器可分为“计数型”和“移位型”2类。

波形图：多个波，一个波到下降沿，另一个波就到达上升沿

![image-20240125221952575](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240125221952575.png)

移位型——由非自然态序的移位寄存器型计数器和译码器构成

可由环形计数器构成

也可由如下构成

![image-20240125223359528](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240125223359528.png)

p87都是相关的构建（利用移位寄存器型计数器或其他计数器译码器构建顺序脉冲发生器，[详细可以参考]([数电87-顺序脉冲发生器_哔哩哔哩_bilibili](https://www.bilibili.com/video/BV1A3411z7Mf?p=87&vd_source=4ec31615294fd2510d5fd40f0183648f))

# 第六章脉冲产生与整形电路

## 矩形脉冲

U~m~矩形脉冲最高点电压

1. 脉冲周期T：周期脉冲相邻两个波形重复出现所需的时间
2. 脉冲频率f：单位时间内脉冲重复的次数f=1/T
3. 脉冲幅度U~m~：脉冲电压的最大变化幅度
4. 脉冲宽度t~w~：脉冲上升沿0.5U~m~到下降沿0.5U~m~所需的时间
5. 上升时间t~r~：脉冲前沿从0.1U~m~（稳定后低电压）上升到0.9U~m~（稳定后高电压）所需的时间
6. 下降时间t~f~：脉冲后沿从0.9U~m~（稳定后高电压）下降到0.1U~m~（稳定后低电压）所需的时间
7. 占空比q：t~w~/T

获取脉冲信号方法：

(1)利用多谐振荡器直接产生。
(2)利用整形电路对已有波形进行整形、变换。
施密特触发器：将缓慢变化或快速变化的非矩形脉冲变换成陡峭的矩形脉冲。
单稳态触发器：将宽度不符合要求的脉冲变换成符合要求的矩形脉冲。

2、脉冲信号产生与整形电路的实现

(1)用门电路构成。(2)用专用的集成电路。(3)用555定时器构成。

### 555定时器

简介：555定时器是一种电路结构简单、使用方便灵活、用途广泛的多功能电路。它的电源电压范围宽(TTL555定时器为4.5~16 V,CMOS 555定时器为3~18 V)，可提供与TTL及CMOS数字电路兼容的接口电平,还可输出一定功率，驱动微电机、指示灯、扬声器等。**TTL单定时器型号的最后3位数字为555，双定时器的为556**; **CMOS单定时器的最后4位数为7555，双定时器的为7556。它们的逻辑功能和外部引线排列完全相同**。

电路图：

![Collage_20240205_180907_edit_1117953865939053](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/Collage_20240205_180907_edit_1117953865939053.jpg)



# 重：硬件描述语言

## 基础

描述模块功能的主要形式有两种:行为模型(behavioral )和结构模型( structural)。行为模型描述一个模块做什么。结构模型应用层次化方法描述一个模块怎样由更简单的部件构造。两种硬件描述语言SystemVerilog 和 VHDL代码可以给出描述布尔函数y=a非b非c非+ab非c非 +ab非c的模块。在两种语言中，模块都命名为sillyfunction，具有3个输人a、b和c，以及一个输出y。

![image-20240208105533909](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240208105533909.png)

&位与，|位或，~非，^异或，assign变量，wire局部变量，？同c一样的条件，||逻辑或，[]向量类似c数组

{a，b}按a，b顺序拼接起来，{}操作符用于连接总线。{3{d[0]}}表示d[0]的3个拷贝。

SystemVerilog文件可以包括说明每一个时间单位值的时间尺度指令。该语句的格式为'timescale unit/precision。在这个文件中，每个时间单位为1ns，模拟精度为1ps。如果在文件中没有给出时间尺度指令，将使用默认的单位和精度(一般两者都是1ns)。在 System Verilog中，#符号用于说明延迟单位的数量。它可以放在assign语句中

复制算子是拼接算子的一种特殊情况，如a={b,b,b,b,b,b}便可以写成==a={6{b}}==的形式。复制算子的格式为：{num{vector}}，其中num必须为常量。注意外面也需要一层大括号

![image-20240208110415080.png](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240208110415080.png)

## 模块化使用

在模块实例化过程中，被例化模块的端口信号是最重要的，用户甚至可以不知道模块的内部结构。

模块实例化一般有两种语法格式，分别称为**<u>基于端口名称的实例化</u>**和**<u>基于端口位置的实例化。</u>**

**<u>基于位置的实例化</u>**和C语言中的函数调用类似（只是语法上类似，实际上该例化会产生实际的硬件电路），以上述`mod_a`模块的实例化为例，可以在上层模块中使用以下语句：

```verilog
module top_module(input wa,input wb,output wc);
mod_a inst_name1(wa,wb,wc);
endmodule
```

其中inst_name1是mod_a模块的实例化名称，可以由用户自定义（类似c语言的typedef），通过这种例化方式，便实现了端口对应：`wa↔in1`, `wb↔in2`, `wc↔out `。
 **<u>基于端口名称的实例化</u>**如下所示

```verilog
module top_module(input wa,input wb,output wc);
mod_a 	inst_name2(
.out		(wc),
.in1		(wa),
.in2		(wb));
endmodule
```

推荐使用基于端口名称的例化方式，因为这种方式编写的代码可读性更强。

==注意==，Verilog bug：基于端口名称例化要将顺序打乱，否则就是两种的混合，无法正常编译。。。。



## 数据类型

reg——wire，logic

由于reg信号经常用在触发器，寄存器，时序电路中，所以会引发混淆（reg与寄存器相关），因此引入了logic类型

assign语句中被赋值信号为wire类型，always块内被赋值信号需定义为reg类型，因此用always需要中间变量时用reg定义，而不是wire

**<u>SystemVerilog</u>**引入logic类型。logic类型是reg类型的同义词，避免误导用户它实际上是否是一个触发器的猜想。而且，SystemVerilog 放宽了assign语句和分层端口实例的规则，所以logic变量可以在always模块的外面使用，而传统语法要求在always模块的外面使用wire变量。**<u>因此，几乎所有的SystemVerilog信号都可以是logic类型</u>**
但也有例外，如果信号有多个驱动源(例如，三态总线)则必须声明为net 类型,当logic信号不小心连接到多驱动源时，这个规则允许SystemVerilog生成错误信息而不是生成x值。

net最常用的类型是wire或tri。这两种类型是同义的，但是传统上wire类型用于单信号源驱动，tri类型用于多信号源驱动。因此，在SystemVerilog中, wire类型已废弃，因为logic类型更常用于单驱动源信号。

当tri变量由一个或多个信号源驱动为某个值时，它就呈现那个值。当它未被驱动时,它呈现浮空值(z)。当它被多个信号源驱动为不同的值(0、1或×)时,它呈现为不确定值

## always过程块使用

所有的数字电路都是由逻辑门和连线构成的，因此理论上来说都可以通过模块的连接和assign语句进行描述，然而在很多情况下这并不是最方便的一种方式，过程块提供了一种更加方便的描述方式，always过程块便是其中最常用的一种。

 对于可综合电路（即能转化成实际电路的verilog描述方式，与之相对的是不可综合电路，多用于电路仿真，不能转换成实际电路），有两种always块的语法形式：

 -组合逻辑电路：always@(**)
 -时序逻辑电路：always@(posedge clk)*

**<u>always块括号内为敏感信号，只有括号内条件满足才会执行块内语句</u>**，因此时序逻辑电路通过括号内上升沿或下降沿控制进行，异步置位或复位要将置位条件也放在括号内，否则会变成同步。

 组合逻辑电路的always块与assign语句等效，用户描述组合逻辑电路时，可根据便利性选择其中一种方式使用。两者生成的硬件电路一般是等效的，但在语法规则上稍有不同：

 -assign语句只能对一个信号进行赋值，always块内可对多个信号进行赋值**（使用begin和end标识开始和结束）**
 -==**assign语句中被赋值信号为wire类型，always块内被赋值信号需定义为reg类型，因此用always需要中间变量时用reg定义，而不是wire**==
 -always块内支持更加丰富的语法，如使用if…else..、case等适合实现交复杂的组合逻辑**（同理要使用语法，需要和上文一样用begin，end标识）**

 例如：下述两条语句是等效的（out1需定义为wire类型，out2需定义为reg类型，但这仅仅是语法上的要求，生成的电路并没有区别）：
 assign out1 = a & b | c ^ d;
 always @(*) out2 = a & b | c ^ d;

always语句后的括号内放的是敏感变量列表，对于上例来说，可以写成always @(a,b,c,d) out2 = a & b | c ^ d，但为了简单起见，我们一般都用符号*代替。

****

### 赋值方式

用always描述的时序逻辑电路，除了像组合逻辑always块那样生成组合逻辑电路外，还会生成一组触发器（或称寄存器），用于寄存组合逻辑的输出。寄存器的输出只有在时钟的上升沿时（`posedge clk`）才会更新，其余时刻均保持不变。
 阻塞赋值和非阻塞赋值：
 在Verilog中，有三种赋值方式，分别为：

- 连续赋值（如`assign x = y;`），该赋值方式只能用于过程块(如always块)之外
- 阻塞赋值（如`x = y;`），该赋值方式只能用在过程块（如`always@（*）`）内即 变量名 = ........
- 非阻塞赋值（如`x <= y;`），一般读作x得到y，该赋值方式只能用在过程块内（如`always@（posedge clk）`）即 变量名 <= .....

在设计Verilog模块时，遵循以下原则：

- 在组合逻辑的always块内采用阻塞赋值
- 时序逻辑的always块内采用非阻塞赋值

**(1).非阻塞(Non_Blocking)赋值方式( 如 b <= a; )**

- 块结束后才完成赋值操作。
- b的值并不是立刻就改变的。==也就是说"always"块内的下一条语句执行后，b并不等于a，而是保持原来的值。"always"块结束后，才进行赋值。==
- 这是一种比较常用的赋值方法。（特别在编写可综合模块时）

**(2).阻塞(Blocking)赋值方式( 如 b = a; )**

- 赋值语句执行完后,块才结束。
- ==b的值在赋值语句执行完后立刻就改变的。==
- 可能会产生意想不到的结果。

**非阻塞赋值方式和阻塞赋值方式的区别常给设计人员带来问题。问题主要是给"always"块内的reg型信号的赋值方式不易把握。**

### tip

- 推荐使用基于端口名称的实例化方式
- 模块调用就像是一个树形的层次结构，不允许循环调用，如a调用b，b又调用a，也不允许模块调用自身，即模块c中又实例化模块c。
- 不允许在进程块（如always、initial等）或赋值语句（如assign语句）内进行模块实例化
- 模块的实例化名称可以自定义，如在同一模块中要对一个模块多次实例化，需要有不同的实例化名称。
- 基于端口名称实例：

```verilog
module top_module(
  input 	a,
  input 	b,
  output 	out
);

// 请用户在下方编辑代码
mod_a in_name(
        .out(out),
        .in1(a),
        .in2(b)
);
//用户编辑到此为止
endmodule

module mod_a ( 
  input 	in1, 
  input 	in2, 
  output 	out 
);
assign out = in1 & in2;
endmodule
```

- 基于端口位置实例：

```verilog
module mod_a (
    output   out1	,
    output   out2	,
    input    in1	,
    input    in2	,
    input    in3	,
    input    in4
);
    assign out1 = in1 & in2 & in3 & in4;    //这只是一个简单的示例
    assign out2 = in1 | in2 | in3 | in4;    //这只是一个简单的示例
endmodule

module top_module ( 
	input	a	,
    input	b	,
    input	c	,
    input	d	,
    output	out1,
    output	out2
);
	//Write your code here
    mod_a fi_name(
        .out1(out1),
        .out2(out2),
        .in1(a),
        .in2(b),
        .in3(c),
        .in4(d)
  );
endmodule
```

## generate块使用

verilog中的generate块可以称为**生成块**，所谓生成，可以理解为复制。

不仅限于模块例化，当同一个操作或模块实例需要多次重复，或者某些代码需要根据给定的Verilog参数有条件地包含时，这些语句特别方便。

generate块可以分为generate for和generate if或者generate case。

### generate for

先设计一个半加器：

```verilog
// Design for a half-adder
module ha ( input   a, b,
            output  sum, cout);

  assign sum  = a ^ b;
  assign cout = a & b;
endmodule
//下面对半加器模块例化N次，N为输入变量的位宽，例如：
input [N-1:0] a, b;
```

每一次对输入变量的一位进行加法运算。
如下：

```verilog
// A top level design that contains N instances of half adder
module my_design
	#(parameter N=2)
		(	input [N-1:0] a, b,
            output [N-1:0] sum, cout);
	// Declare a temporary loop variable to be used during
	// generation and won't be available during simulation
	genvar i;

	// Generate for loop to instantiate N times
	generate
        for (i = 0; i < N; i = i + 1) begin： ha1（模块名）
      	ha u0 (a[i], b[i], sum[i], cout[i]);
		end
	endgenerate
endmodule
```
### generate if

generate if中的条件必须是参数

下面使用generate if语句来选择例化哪一个模块：

```verilog
// Top Level Design: Use a parameter to choose either one
module my_design (	input a, b, sel,
         			output out);
  parameter USE_CASE = 0;

  // Use a "generate" block to instantiate either mux_case
  // or mux_assign using an if else construct with generate
  generate
  	if (USE_CASE)
      mux_case（一个自定module） mc (.a(a), .b(b), .sel(sel), .out(out));
    else
      mux_assign（一个自定module） ma (.a(a), .b(b), .sel(sel), .out(out));
  endgenerate

endmodule
```

### generate case

generate case语句和generate if语句用法无异，和普通的if与case一致。

## 条件语句

### if。else语法

.if…else…可以嵌套使用，如

```verilog
if … 
else if… 
else if… 
else…
```

使用if语句描述组合逻辑时，务必加上else语句，以免产生锁存器（数字电路设计中应尽力避免产生锁存器）

**如果if后要跟多个语法，也要用begin，end标识范围**

### case语句

Verilog中的case语句与C语言中的switch语句类似，如下例所示：

```verilog
 always @(*) begin   // This is a combinational circuit
   case (in)
    1'b1: out = 1'b1; // 对应if(in>=1) 语句
    1'b0: out = 1'b0; // 对应else语句
    default: out = 1'bx; //使用case实现组合逻辑时，必须有default，以防出现锁存器
   endcase      //endcase语句表示case语句结束，两者成对使用
 end
```

 -case语句以关键字**case开始，以endcase结束**，两者成对出现
 -case语句中每个条目只执行一条语句，如要在一个条目下进行多个赋值，需要将多条预计放在begin/end关键字之间
 -case条目**允许重复或部分重叠，第一个匹配到的条目有效，即顺序查找**
 当有多个条目进行选择时，使用case语句比if…else…语句方便很多

****

casez语句：

它将值为z的位在比较中视为无关紧要。
 例如，4输入优先级编码器：
 always @(*) begin
   **<u>casez</u>** (in[3:0])
     4'bzzz1: out = 0;  // in[3:1] can be anything
     4'bzz1z: out = 1;
     4'bz1zz: out = 2;
     4'b1zzz: out = 3;
     default: out = 0;
   endcase
 end
 case语句每个项都是按顺序检查的，因此符合条件就会输出，有某些输入（例如4'b1111）匹配多个条目，则选择第一个匹配项（因此4'b1111匹配第一个项，out=0，而不匹配后面的任何项）。

****

避免锁存：

您的电路有一个16位输入和四个输出，该电路识别这四个扫描码并确认正确的输出。为避免产生锁存，必须在所有四种情况和默认（default）情况下，为所有四个输出指定一个值。这可能涉及许多不必要的输入。因此解决这个问题的一个简单方法是在case语句之前（always之后）为输出分配一个“默认值”：
 always @(*) begin
   up = 1'b0; down = 1'b0; left = 1'b0; right = 1'b0;
   case (scancode)
     ... // Set to 1 if necessary.
   endcase
 end
 这种类型的代码确保在所有可能的情况下为输出赋值（0），除非case语句重写赋值。这也意味着default项变得不必要。

## 归约运算符

有时，需要创建一个对一个向量的所有位进行操作的逻辑门，如（a[0]&a[1]&a[2]&a[3]…），如果向量很长的话，也会很麻烦。归约运算符可以对向量的位进行AND、OR和XOR运算，产生一位输出：

```verilog
& a[3:0] // AND: a[3]&a[2]&a[1]&a[0]. Equivalent to (a[3:0] == 4'hf)
 | b[3:0] // OR: b[3]|b[2]|b[1]|b[0]. Equivalent to (b[3:0] != 4'h0)
 ^ c[2:0] // XOR: c[2]^c[1]^c[0]
```

这些是只有一个操作数的单目运算符（类似于NOT运算符！和 *~*）。您还可以反转这些门的输出来创建NAND、NOR和XNOR门，例如（~&d[7:0]）。

## typedef语句

类似于c语言中的功能，可以定义信号类型

如下：

```verilog
module divideby3FSM(input logic clk,
					input logic reset,
					output logic y);
    typedef enum 1ogic [1:0]{S0,S1,S2} statetype;
    statetype [l:0] state. nextstate;
// state register
always_ff @(posedge clk, posedge reset)
    if （reset)  state<= S0;
	else	    state <= nextstate;
//next state logic
always_comb
case (state)
s0:		nextstate<=S1;
S1:		nextstate<=S2;
S2:		nextstate<=S0;
default:nextstate<=S0;
endcase
//output logic
assign y = (state== S0);
endmodule
```

typedef语句定义了statetype为一个2位logic值，它有3个可能的值:so、s1、s2。state和 nextstate都是statetype类型的信号。
枚举编码默认为数字排序:s0= 00、s1 =01、s2= 10。编码可以由用户显式设置。不过,综合工具只是建议而不要求用户必须显式设置编码。比如，下面的代码段把状态编码为3位的独热值:

typedef enum logic [2:0]{S0=3 'b001，S1=3'b010，S2=3'b100}

statetype;
注意，怎样使用case语句定义状态转换表。因为下一个状态逻辑必须是组合逻辑,所以 dafault是必需的,即使状态2'b11不会出现。
当状态为s0时，输出y为1。如果a等于b，相等比较a==b等于1，否则等于0。不相等比较a! =b则相反，如果a不等于b，则为1。

## 参数化模块

SystemVerilog 允许在输入和输出之前使用#(parameter…)语句定义参数。Parameter语句包括一个默认值( 8)也就是变量名。输入和输出的位数依赖于这个参数。也就说之后输入输出数的数量都可以用该参数表示。如下n为参数

```verilog
module decoder非( parameter N=3)
(input logic [N-1:0]a,output logic[2**N-1:0]y);always_comb
begin
y=0;y[a]=1;end
endmodule
//2**N代表2的n次。
```

这样可以方便对大量相同变量位数进行修改

同时HDL还提供generate语句产生基于参数值的可变数量的硬件。generate支持for循环和if语句来确定产生多少和什么类型的硬件。使用如下：

![image-20240220195248735](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240220195248735.png)

## 异步时序逻辑电路”打拍“

首先，在同步系统中，输入信号总是系统时钟同步，能够达到寄存器的时序要求，所以亚稳态肯定不会发生。在异步系统的信号输出过程中，如果无法满足建立时间和保持时间的要求则会发生亚稳态。

“打一拍”的含义，我们可以理解为**把某个信号延迟了一个时钟周期，推而广之：“打两拍”就是延迟两个时钟周期，“打n拍”就是延迟n个时钟周期。**通俗的讲，打一拍就是系统时钟对外部信号采样一次，把采样的结果数据做为下一步的控制状态！
“打一拍”的目的很简单，就是为了FPGA中时序的正确性！！！

打拍原则：

如果这个输入信号来自异步时钟域(比如FPGA芯片外部的输入)，必须寄存两拍。第一拍将输入信号同步化，同步化后的输出可能带来建立/保持时间的冲突，产生亚稳态。需要再寄存一拍，减少(注意是减少)亚稳态带来的影响。
如果这个输入信号来自于同一时钟域且需要用到跳变沿，需要寄存一拍。否则时序报告多半会报clock skew > data delay，造成建立/保持时间的冲突。

五条原则：
1.全局时钟的跳变沿最可靠。
2.来自异步时钟域的输入需要寄存一次以同步化，再寄存一次以减少亚稳态带来的影响。
3.不需要用到跳变沿的来自同一时钟域的输入，没有必要对信号进行寄存。
4.需要用到跳变沿的来自同一时钟域的输入，寄存一次即可。
5.需要用到跳变沿的来自不同时钟域的输入，需要用到3个触发器，前两个用以同步，第3个触发器的输出和第2个的输出经过逻辑门来判断跳变沿。

方法：

使用D触发器即可

详细原理：[打拍](https://blog.csdn.net/zerokingwang/article/details/127934270?spm=1001.2101.3001.6650.8&utm_medium=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-8-127934270-blog-119619162.235%5Ev43%5Epc_blog_bottom_relevance_base6&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2%7Edefault%7EBlogCommendFromBaidu%7ERate-8-127934270-blog-119619162.235%5Ev43%5Epc_blog_bottom_relevance_base6&utm_relevant_index=13)

单比特信号从慢速时钟域同步到快 速时钟域需要使用打两拍的方式消除亚稳态。 第一级寄存器产生亚稳态并经过自身后可以稳定输出的概率为 70%~80%左右，第二级寄存 器可以稳定输出的概率为 99%左右，后面再多加寄存器的级数改善效果就不明显了，所以 数据进来后一般选择打两拍即可。**<u>这里注意，该方法仅仅适用单比特信号从慢速时钟域同步到快速时钟域，单比特信号从快速时钟域同步到慢速时钟域还仅仅使用打两拍的方式则会漏采数据。</u>**

使用：

1.如何获取信号的沿
首先对想要采集沿的信号(假设是in)进行打一拍的操作存放到临时寄存器中，假设是in_reg 则：
  获取上升沿：in &~ in_reg
  获取下降沿：in_reg &~ in
  获取双边沿：in ^ in_reg
2.同步复位与异步复位
  同步复位：指复位信号在时钟信号触发时，复位才有效
  异步复位：指复位信号不管时钟信号是否有触发，只有复位有效，输出立刻变为0
  写法：
 	 /*同步复位*/
	always @(posedge clk) begin
   	 	if (rst == 1'b? )
       	...	
	end
    /*异步复位*/    
    always @(posedge clk or negedge rst_n) begin
        if (rst_n == 1'b0)
                ...
    end
3.构建一个在功能上表现为双边缘触发触发器的电路
    

```verilog
// After posedge clk, p changes to d^n. Thus q = (p^n) = (d^n^n) = d.
    // After negedge clk, n changes to p^n. Thus q = (p^n) = (p^p^n) = d.
    // At each (positive or negative) clock edge, p and n FFs alternately
    // load a value that will cancel out the other and cause the new value of d to 
```

## 分频

电路中的分频有二种：
1、分频是指将意单一频率信号的频率降低为原来的1/N，就叫N分频。实现分频的电路或装置称为“分频器”。
这里的分频上针对单频信号而言的。

如把33MHZ的信号2分频得到16.5MHZ的信号，3分频得到11MHZ的信号，10分频得到3.3MHZ的信号。
这种分频一般指在数字电路。

2、分频是对信号中不同频率成分的各种信号分开，分成几个频率段。实现分频的电路或装置称为“分频器”。
这里的是针对由很多不同频率成分组成的混合信号而言的。

当时钟信号过快时需要信号速度变慢，这时就需要分频操作，比如4hz时钟到1hz时钟，具体分频措施就是通过设其他变量，通过其他变量的变化符合一个更慢的时钟

==方法就是用触发器实现二分频电路，即满足Qn+1=Qn的非，注意二分频以上如四分频，八分频注意下一个时钟信号上升沿还是下降沿（最好画图确认）==

4hz到1hz的一个例子如下：

```verilog
    reg clk_s = 0;      //4分频1HZ
    reg clk_count = 0;  //用于分频

    always@(posedge clk) begin    //分频
     
        if(reset) begin
            bit1 = 0;
            bit2 = 0;
            clk_count = 0;
            clk_s = 0;
        end
        else begin
            clk_count <= clk_count + 1;//2分频
            if(clk_count)//4分频
                clk_s <= ~clk_s;
            else;
        end
    end
```





## 测试程序

测试程序( testbench)是用于测试其他模块(称为被测设备(Device Under 'Test, DUT))的硬件描述语言模块。测试程序包含了向被测设备提供输人的语句，以便检查是否产生理想的正确输出。输入和期待的输出模式称为测试向量( test vector)。

initial用于always时序逻辑电路中的初始值reg型设置，用法同样也是begin，end中间设置对应变量初始值，注意：在模拟开始时Initial语句执行该段内的语句。Initial语句只能在测试程序上用于模拟,不能用于综合为实际硬件的模块中。第一次启动时，硬件无法执行一系列特殊的步骤。

assert，error使用：

![Collage_20240220_200641](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/Collage_20240220_200641.jpg)

## 有限状态机

一般含有多个always块

注意状态和输出之间的关系，以及reset同步还是异步

一个always为reset导致的原有状态和下一个状态转化

一个always为输入导致的状态变化（唯一一个不是时序）

一个always为输出与状态和输入之间的关系

==尤其要注意输出大多数时候看的是下一个状态，而不是当前状态==

y要用有限状态机的思想思考器件的设计，要先根据要求画出状态转换图，然后按步骤写。

独热信号一般要找出各状态之间的关系，然后用简单的门电路得到各输出。

优点就是电路非常简单，逻辑清晰。但是使用的位数也多

## 实践


verilog部分是基础语法的练习，没有什么好说的
电路部分，第一章组合逻辑熟悉verilog语言的运用，编写简单的基础部件（门电路，复用器，加法器，利用卡诺图实现逻辑电路），这一章为时序逻辑电路做准备，应该没有什么难度
这两部分，注意电路图，真值表，文字要求的题目向verilog语言的转化，学会卡诺图化简法（事半功倍）即可



第二章时序逻辑，第一节锁存器和触发器，熟悉构造你所学的d触发器，边沿触发器，然后构建寄存器，为集成做准备，应该也没有什么难度
这部分有较多波形图分析，波形图看不懂可以在关键位置画竖线（一比一分析），然后得到各部分关系


第二节计数器，灵活运用if，else同时学着去构建module，减少代码数量，可以省去很大一部分工程


第三节移位寄存器，灵活运用case，三目运算符和if，实现多种不同情况的实现
第四节更多电路，这里的题更考究你的数学理解能力，没有什么要点，得到数学关系后，硬推出关系即可。


第四节有限状态机，这里非常考验综合能力，包括题目的理解能力，对前面所构建的电路（计数器，寄存器等等）综合能力
要点就是根据题目条件（纯文字或真值表等等）画出状态转换图，再定出状态和parameter（独特信号选择因题而异）随后一个always块得状态关系，一个得下一个状态转换关系，一个得输出关系
这部分每道题思路都是这样，但是仍有一定难度，要仔细思考各状态输出之间的关系
同时这部分题比较多，但是细心观察很多题只是增加状态，因此可以继承上一道题的答案，然后对其做修改即可，这样可以大幅加快做题速度（熟练运用有限状态机再这样做）


应用部分如果一道题没有思路，推荐把题的关键提炼出来，在纸上写下来，容易发现各自之间的关系，再利用状态转换图，真值表等等方法理清关系，再去编写verilog代码，编码部分细心观察，大部分时候可以简化逻辑，减少代码量

有限状态机
一个题没有状态转换图，就画状态转换图，简单就直接编码
一个题很复杂，状态转换图不好看出结果，就搞出状态转换表，观察各部分跟输出的关系，然后根据得到的关系定下来是否使用独特信号（这种情况一般一个输出会只用一行，简化代码和思考‖因为独特信号特性）否则就老实用普通方法即可
易错点：状态和输出关系；状态之间转化；reset同步还是异步，高低电位触发；什么时候用时序逻辑电路，什么时候用组合逻辑电路

同时，独热信号经常可以与常数加上for来使用。

## 检验

独立模块通过initial和一系列函数如（#延迟信号）组成，通过对使用模块内input赋值，给出结果从而证明编写准确性，一般有三个部分：信号定义（输入输出），信号赋值（对输入进行赋值从而定下输入波形图），例化被测模块（module 名字，实例化过程）。

# 注释

- [ ] 电流符号I，C大写直流信号，i，c小写是输入交变信号。i小写C大写就是表示交变信号，表示两种信号的叠加
- [ ] 逻辑函数写成最小项表达式（标准与或式）：将式子切割开，缺哪个变量补哪个变量，比如F（A，B，C）=AB那么直接补（C+C非）即可。

- [ ] 灌电流，拉电流详细概念：

拉电流与灌电流反映了输出驱动能力。（芯片的拉、灌电流参数值越大，意味着该芯片可以接更多的负载，例如灌电流是负载给的，负载越多，被灌入的电流越大）；

​		**拉即泄，主动输出电流，是从输出口输出电流；**

　　**灌即充，被动输入电流，是从输出端口流入；**

　　**吸则是主动吸入电流，是从输入端口流入。**

　　吸电流和灌电流就是从芯片外电路通过引脚流入芯片内的电流,区别在于吸收电流是主动的，从芯片输入端流入的叫吸收电流。灌入电流是被动的,从输出端流入的叫灌入电流。

　　拉电流是数字电路输出高电平给负载提供的输出电流，灌电流时输出低电平是外部给数字电路的输入电流，**它们实际就是输入、输出电流能力**。

　　吸收电流是对输入端（输入端吸入）而言的，而拉电流（输出端流出）和灌电流（输出端被灌入）是相对输出端而言的。

- [ ] 常用门电路![](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/QQ%E5%9B%BE%E7%89%8720240106140919.png)

器件圆圈正下方为1号管脚

- [ ] 注意取非，经常会有逻辑符取非，此时0有效1无效即低电平有效，高电平无效。
- [ ] ![image-20240222160130211](https://o5orde-oss.oss-cn-beijing.aliyuncs.com/image-20240222160130211.png)

 即a ^ b ^ c ^ d